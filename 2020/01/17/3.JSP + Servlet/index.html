

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/color-ful/img/favicon.png">
  <link rel="icon" href="/color-ful/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="LP">
  <meta name="keywords" content="">
  
  <title>JSP+Servlet - Eureka</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/color-ful/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/color-ful/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"lpgogogo.gitee.io","root":"/color-ful/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/color-ful/js/utils.js" ></script>
  <script  src="/color-ful/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/color-ful/">&nbsp;<strong>Eureka</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/color-ful/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="JSP+Servlet">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      LP
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-01-17 00:00" pubdate>
        2020年1月17日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      18.1k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      254
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">JSP+Servlet</h1>
            
            <div class="markdown-body">
              <h2 id="1-Web-相关概念"><a href="#1-Web-相关概念" class="headerlink" title="1. Web 相关概念"></a>1. Web 相关概念</h2><h3 id="1-1-软件架构"><a href="#1-1-软件架构" class="headerlink" title="1.1 软件架构"></a>1.1 软件架构</h3><ul>
<li><strong>C/S</strong>：客户端/服务器端</li>
<li><strong>B/S</strong>：浏览器/服务器端</li>
</ul>
<h3 id="1-2-资源分类"><a href="#1-2-资源分类" class="headerlink" title="1.2 资源分类"></a>1.2 资源分类</h3><ul>
<li>静态资源：所有用户访问后，得到的结果都是一样的，称为静态资源.静态资源可以直接被浏览器解析<ul>
<li>如： html,css,JavaScript</li>
</ul>
</li>
<li>动态资源:每个用户访问相同资源后，得到的结果可能不一样。称为动态资源。动态资源被访问后，需要先转换为静态资源，在返回给浏览器<ul>
<li>如：servlet/jsp,php</li>
</ul>
</li>
</ul>
<p><font color="cornflowerblue">图解：</font></p>
<p><img src="/color-ful/img/javaee/%E8%B5%84%E6%BA%90%E5%88%86%E7%B1%BB%E5%9B%BE%E8%A7%A3.png" srcset="/color-ful/img/loading.gif" lazyload></p>
<h3 id="1-3-网络通信三要素"><a href="#1-3-网络通信三要素" class="headerlink" title="1.3 网络通信三要素"></a>1.3 网络通信三要素</h3><ul>
<li><strong>IP</strong>：电子设备在网络中的唯一标识。</li>
<li><strong>端口</strong>：应用程序在计算机中的唯一标识。 0~65536</li>
<li><strong>传输协议</strong>：规定了数据传输的规则<ol>
<li>基础协议：<ol>
<li>tcp:安全协议，三次握手。 速度稍慢</li>
<li>udp：不安全协议。 速度快</li>
</ol>
</li>
</ol>
</li>
</ul>
<h2 id="2-服务器"><a href="#2-服务器" class="headerlink" title="2. 服务器"></a>2. 服务器</h2><ul>
<li>服务器：安装了服务器软件的计算机</li>
<li>服务器软件：接收用户的请求，处理请求，做出响应</li>
<li>web服务器软件：接收用户的请求，处理请求，做出响应。<ul>
<li>在web服务器软件中，可以部署web项目，让用户通过浏览器来访问这些项目</li>
<li>动态资源必须依赖于web服务器才能运行，所以也被称为web容器</li>
</ul>
</li>
<li>常见的Java相关的web服务器软件：<ul>
<li>webLogic：oracle公司，大型的JavaEE服务器，支持所有的JavaEE规范，收费的。</li>
<li>webSphere：IBM公司，大型的JavaEE服务器，支持所有的JavaEE规范，收费的。</li>
<li>JBOSS：JBOSS公司的，大型的JavaEE服务器，支持所有的JavaEE规范，收费的。</li>
<li>Tomcat：Apache基金组织，中小型的JavaEE服务器，仅仅支持少量的JavaEE规范servlet/jsp。<strong>开源的，免费的</strong>。Tomcat性能优异，并且支持集群，所以深受广大企业喜爱。</li>
</ul>
</li>
</ul>
<h2 id="3-Tomcat"><a href="#3-Tomcat" class="headerlink" title="3.Tomcat"></a>3.Tomcat</h2><h3 id="3-1-下载："><a href="#3-1-下载：" class="headerlink" title="3.1 下载："></a>3.1 下载：</h3><p>进入官网<a target="_blank" rel="noopener" href="http://tomcat.apache.org/">http://tomcat.apache.org/</a> 下载8.5.61</p>
<p><img src="/color-ful/img/javaee/image-20210114225248564.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210114225248564"></p>
<p><img src="/color-ful/img/javaee/image-20210114231730133.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210114231730133"></p>
<h3 id="3-2-安装："><a href="#3-2-安装：" class="headerlink" title="3.2 安装："></a>3.2 安装：</h3><p>​        解压即可使用</p>
<ul>
<li><strong><font color="red">建议：安装目录不建议有中文 和 空格</font></strong></li>
</ul>
<h3 id="3-3-目录结构："><a href="#3-3-目录结构：" class="headerlink" title="3.3 目录结构："></a>3.3 目录结构：</h3><p><img src="/color-ful/img/javaee/image-20210114233535752.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210114233535752"></p>
<h3 id="3-4-卸载："><a href="#3-4-卸载：" class="headerlink" title="3.4 卸载："></a>3.4 卸载：</h3><p>​        删除文件夹即可</p>
<h3 id="3-5-启动："><a href="#3-5-启动：" class="headerlink" title="3.5 启动："></a>3.5 启动：</h3><p>​            <strong><font color="red">bin/start.bat</font></strong> </p>
<ul>
<li>错误1：启动报错<ul>
<li>解决方案：logs —》catalina.当天日期.log 日志文件中查找错误信息 —-》百度</li>
</ul>
</li>
<li>错误2：启动窗口闪退<ul>
<li>解决方案：JAVA_HOME配置有问题，正确配置后，便修复此问题</li>
</ul>
</li>
<li>错误3：错误日志中出现：端口号占用错误<ul>
<li>解决方案1：cmd —&gt; 命令：netstat -ano —&gt; 找到对应端口的PID —-&gt;任务管理器中 ”详细信息“选项卡—&gt;找到对应PID —&gt; 右键 —-&gt;结束任务</li>
<li>解决方案2：修改Tomcat 默认端口号 conf —&gt; server.xml —&gt; 找到对应的 8080 进行修改。<ul>
<li><font color="red">特殊端口（80）:80端口号是http协议的默认端口号,设置为80，在访问服务器时，就不用输入端口号</font></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-6-访问："><a href="#3-6-访问：" class="headerlink" title="3.6 访问："></a>3.6 访问：</h3><p>​            浏览器输入:Http://localhost:8080 访问本机服务器</p>
<p>​                                Http://他人的ip：8080 访问他人的服务器</p>
<h3 id="3-7-关闭："><a href="#3-7-关闭：" class="headerlink" title="3.7 关闭："></a>3.7 关闭：</h3><ul>
<li>正常关闭<ul>
<li>bin/shutdown.bat</li>
<li>启动窗口：Ctrl + C  </li>
</ul>
</li>
<li>强制关闭 <ul>
<li>点击启动窗口右上角的关闭按钮 <code>X</code></li>
</ul>
</li>
</ul>
<h3 id="3-8-项目部署"><a href="#3-8-项目部署" class="headerlink" title="3.8 项目部署"></a>3.8 项目部署</h3><p><strong><font color="red">方式1：直接将项目复制到webapps目录中</font></strong></p>
<p><font color="cornflowerblue">1. 我们建一个目录，里面放一个html文件：演示案例目录结构<code>Myweb\index.html</code></font></p>
<p><font color="cornflowerblue">2.将文件夹复制到目录中</font></p>
<p><font color="cornflowerblue">3.启动服务</font></p>
<p><font color="cornflowerblue">4.通过浏览器访问项目：<code>localhost:8080/Myweb/index.html</code></font></p>
<ul>
<li><code>/Myweb</code>:项目访问路径，其实它是一个虚拟路径，没有配置前，默认是实际路径。</li>
</ul>
<p><font color="red">这种方式还有一种简化部署方式：将项目打包成war包，因为war包 和zip压缩包的压缩方式比较相似，所以我们直接把演示案例项目压缩成zip格式，然后将后缀改成<code>.war</code>。将压缩好的war包，复制到webapps目录中，这种方式不用重新启动服务器，它会自动给我们部署，删除只需要删除war包，对应的项目也会自动被删除</font></p>
<p><strong>缺点：需要拷贝项目到webapps,耗时耗力</strong></p>
<p><strong><font color="red">方式2：通过配置server.xml</font></strong></p>
<p><font color="cornflowerblue">1.在配置文件中找到Host标签</font></p>
<p><font color="cornflowerblue">2.在Host标签中加入配置：</font></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Context</span> <span class="hljs-attr">docBase</span>=<span class="hljs-string">&quot;D:\Myweb&quot;</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/baidu&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>Context 是一个自闭和标签</li>
<li>docBase: 项目存放的实际路径</li>
<li>path: 访问的虚拟路径</li>
</ul>
<p><strong>缺点：server.xml是针对服务器的配置文件，一般我们不会修改这个文件，容易导致服务器崩溃。</strong></p>
<p><strong><font color="red">方式3：在conf\Catalina\localhost 文件夹下创建 虚拟路径.xml</font></strong></p>
<p><font color="cornflowerblue">1. 在conf\Catalina\localhost目录下创建一个<code>.xml</code>配置文件</font></p>
<p><font color="cornflowerblue">2. 该配置文件名就是访问的虚拟路径</font></p>
<p><font color="cornflowerblue">3.文件中加入<code>Context</code>标签，并配置属性即可。</font></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;Context <span class="hljs-attribute">docBase</span>=<span class="hljs-string">&quot;D:\Myweb&quot;</span> <span class="hljs-attribute">path</span>=<span class="hljs-string">&quot;/baidu&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p><strong>该方式的好处：1.不用修改服务器配置文件，2.热部署：部署和删除不需要重启服务器。</strong></p>
<h2 id="4-IDEA-与-Tomcat集成"><a href="#4-IDEA-与-Tomcat集成" class="headerlink" title="4. IDEA 与 Tomcat集成"></a>4. IDEA 与 Tomcat集成</h2><p>IDEA 与 Tomcat集成的好处，启动，关闭，部署项目都非常方便，不用再去安装目录的bin中找程序之类的操作</p>
<p><font color="cornflowerblue">1.Run —- Edit Configurations…</font></p>
<p><img src="/color-ful/img/javaee/image-20210115092112191.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115092112191"></p>
<p><font color="cornflowerblue">2. 点击左上角的 <code>+</code></font></p>
<p><img src="/color-ful/img/javaee/image-20210115092532058.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115092532058"></p>
<p><font color="cornflowerblue">3.选择：Tomcat Server —– Local</font></p>
<p><img src="/color-ful/C:/Users\30526\AppData\Roaming\Typora\typora-user-images\image-20210115101654152.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115101654152"></p>
<p><font color="cornflowerblue">4. Configureation —-  Tomcat Home — 选择Tomcat安装目录即可</font></p>
<p><img src="/color-ful/img/javaee/image-20210115101915576.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115101915576"></p>
<p><font color="cornflowerblue">5. 配置成功后，IDEA的Run 会变成 Tomcat样式</font></p>
<p><img src="/color-ful/img/javaee/image-20210115101816818.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115101816818"></p>
<h2 id="5-创建JavaWeb项目"><a href="#5-创建JavaWeb项目" class="headerlink" title="5. 创建JavaWeb项目"></a>5. 创建JavaWeb项目</h2><p><font color="cornflowerblue">1. 新建一个普通java工程（Module 或Project 都可以）</font></p>
<p><font color="cornflowerblue">2. 项目名称上右键 — &gt; add </font></p>
<p><img src="/color-ful/img/javaee/image-20210115103548273.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115103548273"></p>
<p><font color="cornflowerblue">3. 选择 Web Application</font></p>
<p><img src="/color-ful/img/javaee/image-20210115103714775.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115103714775"></p>
<p>成功之后，该java项目会多出几个目录结构</p>
<p><img src="/color-ful/img/javaee/image-20210115103916141.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115103916141"></p>
<h2 id="6-部署JavaWeb项目"><a href="#6-部署JavaWeb项目" class="headerlink" title="6. 部署JavaWeb项目"></a>6. 部署JavaWeb项目</h2><p><font color="cornflowerblue">1. Run —- Edit Configurations…</font></p>
<p><img src="/color-ful/img/javaee/image-20210115104052623.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115104052623"></p>
<p><font color="cornflowerblue">2. 选 Artifact…</font></p>
<p><img src="/color-ful/img/javaee/image-20210115104401827.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115104401827"></p>
<p><font color="cornflowerblue">3. 在弹出的窗口中，选择你要部署的JavaWeb项目</font></p>
<p><img src="/color-ful/img/javaee/image-20210115104444368.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115104444368"></p>
<p><font color="cornflowerblue">4. 配置虚拟访问路径（也可以不配置）</font></p>
<p><img src="/color-ful/img/javaee/image-20210115104728339.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115104728339"></p>
<p><font color="cornflowerblue">5. 配置热部署，这样我们新建页面就不必重新启动服务器了。</font></p>
<p><img src="/color-ful/img/javaee/image-20210115105208509.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115105208509"></p>
<p><font color="cornflowerblue">6. 以上配置完成后，就可以点击启动Tomcat，访问你的第一个页面啦！</font></p>
<h2 id="7-Servlet"><a href="#7-Servlet" class="headerlink" title="7. Servlet"></a>7. Servlet</h2><h3 id="7-1-概述"><a href="#7-1-概述" class="headerlink" title="7.1 概述"></a>7.1 概述</h3><p>​    运行在服务器端的java小程序</p>
<p><font color="cornflowerblue">图解：</font></p>
<p><img src="/color-ful/img/javaee/servlet%E5%9B%BE%E8%A7%A3.png" srcset="/color-ful/img/loading.gif" lazyload></p>
<ul>
<li>Servlet是一个接口，定义了Java类被Tomcat识别的规则。</li>
<li>Servlet的开发就是实现Servlet接口，重写里面的方法。</li>
</ul>
<h3 id="7-2-快速入门"><a href="#7-2-快速入门" class="headerlink" title="7.2 快速入门"></a>7.2 快速入门</h3><ul>
<li><p><strong>步骤</strong></p>
<ol>
<li>创建JavaEE项目</li>
<li>定义一个类，实现Servlet接口</li>
<li>实现接口中的抽象方法</li>
<li>配置Servlet</li>
</ol>
<p><font color="cornflowerblue">1. 在刚才创建的web工程的src目录中创建包 org.wdzl.web.servlet，并创建一个类ServletDemo</font></p>
<p><font color="cornflowerblue">2. 实现Servlet接口</font></p>
</li>
</ul>
<p>​    <font color="red">注意：实现接口时会发现，找不到依赖</font></p>
<ul>
<li>解决办法<ol>
<li>File —&gt; Project Structure</li>
</ol>
</li>
</ul>
<p><img src="/color-ful/img/javaee/image-20210115112536294.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115112536294"></p>
<ol start="2">
<li>选择 Library</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210115112707490.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115112707490"></p>
<ol start="3">
<li>选择 Tomcat 8.5.61—&gt; Add Selected</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210115112803662.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210115112803662"></p>
<p><font color="cornflowerblue">3. 重写的方法我们先不管是干什么的，我们先找到service方法</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">//提供服务的方法</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">service</span><span class="hljs-params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;Hello Servlet&quot;</span>);<span class="hljs-comment">//写一条输出语句即可</span><br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><font color="cornflowerblue">4. 配置Servlet</font></p>
<blockquote>
<p><font color="red">为什么要配置Servlet?</font></p>
<p>因为浏览器要访问动态资源是要通过URL，而URL 如何要和Servlet对应上，就是我们接下来要做的事情。</p>
</blockquote>
<p>在<code>web.xml</code>中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 配置Servlet --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>demo1<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.wdzl.web.servlet.ServletDemo<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>demo1<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 访问Servlet的虚拟路径 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/demo1<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>配置好后通过localhost/demo1进行访问即可</p>
<h3 id="7-3-servlet执行原理"><a href="#7-3-servlet执行原理" class="headerlink" title="7.3 servlet执行原理"></a>7.3 servlet执行原理</h3><p><font color="cornflowerblue">图解：</font></p>
<p><img src="/color-ful/img/javaee/Servlet%E5%8E%9F%E7%90%86%E5%9B%BE%E8%A7%A3.png" srcset="/color-ful/img/loading.gif" lazyload></p>
<p><strong>执行原理</strong></p>
<ol>
<li>服务器接收到浏览器的请求后，会解析请求URL路径，获取访问的Servlet的资源路径</li>
<li>查找web.xml文件，是否有对应的<code>&lt;url-pattern&gt;</code></li>
<li>如果有，则会找到对应的<code>servlet-class</code>全类名</li>
<li>tomcat将对应的字节码文件加载到内存中，并创建该类的对象</li>
<li>调用方法</li>
</ol>
<h3 id="7-4-Servlet的方法-和-生命周期"><a href="#7-4-Servlet的方法-和-生命周期" class="headerlink" title="7.4 Servlet的方法 和 生命周期"></a>7.4 Servlet的方法 和 生命周期</h3><ol>
<li><p><strong>生命周期</strong></p>
<ul>
<li>被创建：执行init方法，只执行一次</li>
<li>提供服务: 执行service方法，执行多次</li>
<li>被销毁：执行destroy,只执行一次</li>
</ul>
</li>
<li><p><strong>方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  初始化的方法</span><br><span class="hljs-comment"> *  在Servlet被创建时执行，只会执行一次</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> servletConfig</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> ServletException</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(ServletConfig servletConfig)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;init...&quot;</span>);<br>&#125;<br>   <br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取ServletConfig对象</span><br><span class="hljs-comment"> * ServletConfig：Servlet的配置对象</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ServletConfig <span class="hljs-title">getServletConfig</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br>   <br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 提供服务方法</span><br><span class="hljs-comment"> * 每次Servlet被访问时执行，执行多次。</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> servletRequest</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> servletResponse</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> ServletException</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IOException</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">service</span><span class="hljs-params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;Hello Servlet&quot;</span>);<br>&#125;<br>   <br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取Servlet的一些信息，版本，作者等</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getServletInfo</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br>   <br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 销毁的方法</span><br><span class="hljs-comment"> * 在Servlet销毁或在服务器正常关闭时，被执行一次</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;destroy...&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-5-Servlet方法详解"><a href="#7-5-Servlet方法详解" class="headerlink" title="7.5 Servlet方法详解"></a>7.5 Servlet方法详解</h3><ol>
<li><p>init():</p>
<ul>
<li>初始化的时机可以改变</li>
</ul>
<p><img src="/color-ful/img/javaee/image-20210116095734091.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116095734091"></p>
<ul>
<li>Servlet是单例模式，多个用户访问可能存在线程安全问题<ul>
<li>解决：使用Servlet时，尽量不要在Servlet中使用成员变量 ，即使定义了成员变量，也不要有修改值的操作。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="7-6-注解配置"><a href="#7-6-注解配置" class="headerlink" title="7.6 注解配置"></a>7.6 注解配置</h3><p><font color="red">配置文件方式配置比较麻烦，3.0之后的版本支持注解方式，比较方便</font></p>
<ul>
<li><strong>步骤：</strong><ol>
<li>创建JavaEE项目，选择3.0以上版本，可以不创建web.xml</li>
<li>定义一个类，实现Servlet接口</li>
<li>重写方法</li>
<li>在类上使用注解进行配置</li>
</ol>
</li>
<li>准备工作:重新创建一个，这次不勾选 <code>Create web.xml</code></li>
</ul>
<p><img src="/color-ful/img/javaee/image-20210116102659318.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116102659318"></p>
<p><font color="cornflowerblue">1. 定义一个类，实现Servlet接口，重写方法</font></p>
<p><font color="cornflowerblue">2.在类上使用注解进行配置 </font></p>
<p><img src="/color-ful/img/javaee/image-20210116112625361.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116112625361"></p>
<p><font color="cornflowerblue">3. 注解 WebServlet</font></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>String</td>
<td>指定Servlet 的 name 属性，等价于 <code>&lt;servlet-name&gt;</code>。如果没有显式指定，则该 Servlet 的取值即为类的全限定名。</td>
</tr>
<tr>
<td>value</td>
<td>String[]</td>
<td>该属性等价于 urlPatterns 属性。两个属性不能同时使用。使用时可以省略属性名。</td>
</tr>
<tr>
<td>urlPatterns</td>
<td>String[]</td>
<td>指定一组 Servlet 的 URL 匹配模式。等价于<code>&lt;url-pattern&gt;</code>标签。</td>
</tr>
<tr>
<td>loadOnStartup</td>
<td>int</td>
<td>指定 Servlet 的加载顺序，等价于 <code>&lt;load-on-startup&gt;</code>标签。</td>
</tr>
<tr>
<td>initParams</td>
<td>WebInitParam[]</td>
<td>指定一组 Servlet 初始化参数，等价于<code>&lt;init-param&gt;</code>标签。</td>
</tr>
<tr>
<td>asyncSupported</td>
<td>boolean</td>
<td>声明 Servlet 是否支持异步操作模式，等价于<code>&lt;async-supported&gt;</code> 标签。</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>该 Servlet 的描述信息，等价于 <code>&lt;description&gt;</code>标签。</td>
</tr>
<tr>
<td>displayName</td>
<td>String</td>
<td>该 Servlet 的显示名，通常配合工具使用，等价于 <code>&lt;display-name&gt;</code>标签。</td>
</tr>
</tbody></table>
<h3 id="7-7-小常识："><a href="#7-7-小常识：" class="headerlink" title="7.7 小常识："></a>7.7 小常识：</h3><ol>
<li> 工作空间项目 和 tomcat部署的web项目 并不是一个项目</li>
</ol>
<p>tomcat部署位置：<code>CATALINA_BASE\work</code></p>
<p>工作空间项目位置：项目右键</p>
<ol>
<li>WEB-INFO目录下的资源不能被浏览器直接访问</li>
</ol>
<h3 id="7-8-Servlet-继承体系结构"><a href="#7-8-Servlet-继承体系结构" class="headerlink" title="7.8 Servlet 继承体系结构"></a>7.8 Servlet 继承体系结构</h3><p>查询API 我们了解一下Servlet的继承体系结构：</p>
<p>Servlet 接口</p>
<p>​        |</p>
<p>GenericServlet 抽象类</p>
<p>​        |</p>
<p>HttpServlet 抽象类</p>
<ul>
<li><strong>GenericServlet  抽象类</strong></li>
</ul>
<p>它将Servlet接口中的其他方法都做了空实现，只留下了service()方法作为抽象方法</p>
<ul>
<li><p><strong>HttpServlet 抽象类</strong></p>
<p>该抽象类是对Http协议的一种封装，可以简化操作。</p>
<p><font color="cornflowerblue">图解：</font></p>
<p><img src="/color-ful/img/javaee/HttpServlet.png" srcset="/color-ful/img/loading.gif" lazyload></p>
</li>
</ul>
<h3 id="7-9-HttpServlet"><a href="#7-9-HttpServlet" class="headerlink" title="7.9 HttpServlet"></a>7.9 HttpServlet</h3><ul>
<li><p><strong>使用步骤</strong></p>
<ol>
<li>定义类，继承HttpServlet</li>
<li>重写doGet()/doPost()</li>
</ol>
</li>
<li><p><strong>查看源码，理解原理</strong></p>
</li>
</ul>
<p><font color="cornflowerblue">HttpServlet 中的 service()方法</font></p>
<p><img src="/color-ful/img/javaee/image-20210116160343347.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116160343347"></p>
<p><font color="cornflowerblue">service（）继续往下翻</font></p>
<p><strong>因为Http有7种请求方式，我们只需要关注常用的两个 Get 和 Post</strong></p>
<p><img src="/color-ful/img/javaee/image-20210116160428838.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116160428838"></p>
<ul>
<li><strong>get()方式效果演示</strong></li>
</ul>
<p><font color="cornflowerblue">1. 新建一个ServletDemo2</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/demo2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;doGet...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;doPost...&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><font color="cornflowerblue">2. 启动服务，直接用浏览器请求该Servlet</font></p>
<p><font color="red">注意：浏览器默认访问方式是GET() 方式</font></p>
<ul>
<li><strong>post() ：方式</strong></li>
</ul>
<p><font color="cornflowerblue">1. post方式需要借助Html的<code>&lt;form&gt;</code>标签</font></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;demo2&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;登录&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="7-10-urlPatterns"><a href="#7-10-urlPatterns" class="headerlink" title="7.10 urlPatterns()"></a>7.10 urlPatterns()</h3><ol>
<li><strong>一个Servlet可以匹配多个访问路径</strong></li>
</ol>
<p><font color="cornflowerblue">注解源码：</font></p>
<p><img src="/color-ful/img/javaee/image-20210116170103681.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116170103681"></p>
<p>urlPatterns 的数据类型是String类型的数组，就表示 该servlet可以设置多个访问路径</p>
<p><font color="cornflowerblue">演示案例：</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(urlPatterns = &#123;&quot;/a&quot;,&quot;/a2&quot;,&quot;/a3&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ServletDemo3 doGet()....&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ServletDemo3 doPost()....&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<ol start="2">
<li><strong>路径定义规则</strong><ul>
<li>路径匹配：<code>/xxx</code></li>
<li>目录结果匹配：<code>/xxx/xxx</code></li>
<li>扩展名匹配：<code>*.xxx</code></li>
</ul>
</li>
</ol>
<p><font color="cornflowerblue">案例：</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//@WebServlet(&quot;/aa/bb&quot;) 通过/aa/bb 访问</span><br><span class="hljs-comment">//@WebServlet(&quot;/aa/*&quot;) 通过/aa/任意字符 访问</span><br><span class="hljs-comment">//@WebServlet(&quot;/*&quot;) 通过/任意字符访问</span><br><span class="hljs-meta">@WebServlet(&quot;*.do&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletDemo4</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;demo4 doGet()&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;demo4 doPost()&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="8-HTTP-请求消息"><a href="#8-HTTP-请求消息" class="headerlink" title="8. HTTP - 请求消息"></a>8. HTTP - 请求消息</h2><h3 id="8-1-概念"><a href="#8-1-概念" class="headerlink" title="8.1 概念"></a>8.1 概念</h3><p>超文本传输协议：Hyper Text Transfer Protocol 超文本传输协议</p>
<h3 id="8-2-特点"><a href="#8-2-特点" class="headerlink" title="8.2 特点"></a>8.2 特点</h3><ol>
<li>基于TCP/IP的高级协议：安全的</li>
<li>默认端口号:80</li>
<li>基于请求/相应模型：一次请求对应一次相应</li>
</ol>
<p><font color="cornflowerblue">图示：</font></p>
<p><img src="/color-ful/img/javaee/%E8%AF%B7%E6%B1%82%E7%9B%B8%E5%BA%94%E6%A8%A1%E5%9E%8B.png" srcset="/color-ful/img/loading.gif" lazyload></p>
<ol>
<li>无状态的：每次请求之间相互独立，不能交互数据</li>
</ol>
<h3 id="8-3-历史版本"><a href="#8-3-历史版本" class="headerlink" title="8.3 历史版本"></a>8.3 历史版本</h3><p><font color="cornflowerblue">演示：使用火狐浏览器</font></p>
<p>我们访问baidu首页一共发送了几次请求？实际访问百度主页会发送很多次请求，因为主页的每一个图片，文本内容都是一次请求</p>
<p><img src="/color-ful/img%5Cimage-20210116205730403.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116205730403"></p>
<ol>
<li><strong>1.0</strong>：每一次请求响应都会建立新的连接</li>
<li><strong>1.1</strong>：复用连接，请求连接不会立马释放，会保留一段时间，如果在时间内该链接还有数据进行传输，就会复用该连接。</li>
</ol>
<h2 id="9-请求消息-数据格式"><a href="#9-请求消息-数据格式" class="headerlink" title="9. 请求消息- 数据格式"></a>9. 请求消息- 数据格式</h2><p><strong>数据格式</strong>：<br>        1. 请求行<br>        2. 请求头<br>        3. 请求空行<br>        4. 请求体JSP + Servlet</p>
<p><font color="cornflowerblue">演示案例：使用post()演示案例结合火狐浏览器查看数据格式</font></p>
<p><img src="/color-ful/img/javaee/image-20210116211436008.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116211436008"></p>
<h3 id="9-1-请求行"><a href="#9-1-请求行" class="headerlink" title="9.1 请求行"></a>9.1 请求行</h3><ul>
<li><strong>格式</strong>：请求方式  请求URL  请求协议/版本号</li>
</ul>
<p><font color="cornflowerblue">结合演示案例得出案例种请求行的信息：</font></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string"></span> /demo/login.html <span class="hljs-string"></span> <span class="hljs-meta">HTTP/1.1</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p><strong>请求方式：</strong>Http共有7种请求方式，常用的有2种</p>
<ul>
<li><p>GET</p>
<ol>
<li><p><font color="red">请求参数在请求行中，在URL后</font></p>
<p><img src="/color-ful/img/javaee/image-20210116214119197.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116214119197"></p>
</li>
<li><p>请求的URL长度是有限制的</p>
</li>
<li><p>不安全</p>
</li>
</ol>
</li>
<li><p>POST</p>
<ol>
<li><font color="red">请求参数在请求体中</font></li>
<li>请求的URL长度没有限制</li>
<li>相对安全</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>请求URL</strong></p>
<ul>
<li>GET<ol>
<li>URL可能携带参数</li>
</ol>
</li>
<li>POST<ol>
<li>URL不携带参数</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="9-2-请求头"><a href="#9-2-请求头" class="headerlink" title="9.2 请求头"></a>9.2 请求头</h3><p>请求头内容就是浏览器告诉服务器自身的一些信息。</p>
<ul>
<li><strong>格式</strong>：请求头名称 ： 请求头值 ，请求头值，……</li>
</ul>
<p><font color="cornflowerblue">结合演示案例得出案例种请求行的信息：</font></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Host</span>: localhost:<span class="hljs-number">8080</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>; rv:<span class="hljs-number">84</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">84</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">15</span><br><span class="hljs-attribute">Origin</span>: http://localhost:<span class="hljs-number">8080</span><br><span class="hljs-attribute">Connection</span>: keep-alive<br><span class="hljs-attribute">Referer</span>: http://localhost:<span class="hljs-number">8080</span>/demo/login.html<br><span class="hljs-attribute">Cookie</span>: JSESSIONID=EA<span class="hljs-number">1651</span>C<span class="hljs-number">97732902</span>D<span class="hljs-number">299</span>C<span class="hljs-number">5</span>CD<span class="hljs-number">859</span>AE<span class="hljs-number">1647</span>; Idea-e<span class="hljs-number">44921</span>c<span class="hljs-number">1</span>=<span class="hljs-number">1</span>d<span class="hljs-number">14</span>f<span class="hljs-number">60</span>c-<span class="hljs-number">0164</span>-<span class="hljs-number">4</span>cc<span class="hljs-number">4</span>-<span class="hljs-number">9</span>ed<span class="hljs-number">0</span>-<span class="hljs-number">2</span>d<span class="hljs-number">9</span>d<span class="hljs-number">05535</span>a<span class="hljs-number">13</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<ul>
<li><p><strong>常见的请求头</strong></p>
<ul>
<li><p>Host：发送请求的主机</p>
</li>
<li><p>User-Agent: 浏览器告诉服务器，当前浏览器的版本信息</p>
<ul>
<li>可以在服务器端获取浏览器版本信息，来解决浏览器兼容问题（原因：静态页面的解析都是浏览器自己完成的。这就造成了相同的内容，在不同浏览器中可能出现不同的样式。）</li>
</ul>
</li>
<li><p>Accept: 浏览器告诉服务器自己支持的数据格式</p>
</li>
<li><p>Referer:告诉服务器当前请求从哪里来</p>
<ul>
<li><p>作用：</p>
<ol>
<li><p>防盗链</p>
<p><img src="/color-ful/img/javaee/%E7%9B%97%E9%93%BE%E5%9B%BE%E8%A7%A3.png" srcset="/color-ful/img/loading.gif" lazyload></p>
</li>
<li><p>统计工作</p>
<p><img src="/color-ful/img/javaee/%E9%98%B2%E7%9B%97%E9%93%BE%E5%92%8C%E7%BB%9F%E8%AE%A1.png" srcset="/color-ful/img/loading.gif" lazyload></p>
</li>
</ol>
</li>
</ul>
</li>
<li><p>Connection:keep-alive （现在都使用的HTTP 1.1 所以该头信息被省略）</p>
</li>
</ul>
</li>
</ul>
<h3 id="9-3-请求空行"><a href="#9-3-请求空行" class="headerlink" title="9.3 请求空行"></a>9.3 请求空行</h3><ul>
<li>空行：用于分割请求头 和请求体</li>
</ul>
<h3 id="9-4-请求体（正文）"><a href="#9-4-请求体（正文）" class="headerlink" title="9.4 请求体（正文）"></a>9.4 请求体（正文）</h3><p>​    封装POST 请求信息的请求参数</p>
<p><font color="cornflowerblue">GET方式种没有请求体，我们可以看表单提交后的效果</font></p>
<p><img src="/color-ful/img/javaee/image-20210116212753552.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116212753552"></p>
<ul>
<li>参数 = 对应的值</li>
</ul>
<ol>
<li><strong>请求消息-格式：</strong></li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html">POST /demo/demo2 HTTP/1.1<br>Host: localhost:8080<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>Accept-Encoding: gzip, deflate<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 15<br>Origin: http://localhost:8080<br>Connection: keep-alive<br>Referer: http://localhost:8080/demo/login.html<br>Cookie: JSESSIONID=EA1651C97732902D299C5CD859AE1647; Idea-e44921c1=1d14f60c-0164-4cc4-9ed0-2d9d05535a13<br>Upgrade-Insecure-Requests: 1<br><br>username=hahaha<br></code></pre></td></tr></table></figure>

<h2 id="10-Request-对象"><a href="#10-Request-对象" class="headerlink" title="10. Request 对象"></a>10. Request 对象</h2><h3 id="10-1-Request-和-Response-对象的原理"><a href="#10-1-Request-和-Response-对象的原理" class="headerlink" title="10.1 Request 和 Response 对象的原理"></a>10.1 Request 和 Response 对象的原理</h3><p><font color="red">Response对象后面细讲：</font></p>
<p><font color="cornflowerblue">图解：</font></p>
<p>![](/img/javaee/Request  和 Response对象 .png)</p>
<p><strong>通过原理图，我们得出</strong></p>
<ol>
<li> request 和 response对象是由服务器创建，我们使用即可</li>
<li>request对象是用来获取请求信息，response对象用设置相应信息</li>
</ol>
<h3 id="10-2-Request继承体系"><a href="#10-2-Request继承体系" class="headerlink" title="10.2 Request继承体系"></a>10.2 Request继承体系</h3><p>查询API</p>
<p><strong>ServletRequest</strong> – 接口</p>
<p>​            | 继承</p>
<p><strong>HttpServletRequest</strong> – 接口</p>
<p>​            | 实现（service中打印request对象）</p>
<p><strong>org.apache.catalina.connector.RequestFacade</strong> – 在tomcat中实现            </p>
<p><img src="/color-ful/img/javaee/image-20210116234832122.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116234832122"></p>
<h3 id="10-3-获取请求消息数据"><a href="#10-3-获取请求消息数据" class="headerlink" title="10.3 获取请求消息数据"></a>10.3 获取请求消息数据</h3><h4 id="10-3-1获取请求行数据"><a href="#10-3-1获取请求行数据" class="headerlink" title="10.3.1获取请求行数据"></a>10.3.1获取请求行数据</h4><p>我们根据请求行数据格式分析需要的方法</p>
<p>GET  /demo/demo2 HTTP/1.1</p>
<ul>
<li><p>获取请求方式：GET</p>
<p>​        <strong>String   getMethod()</strong>  </p>
</li>
<li><p><font color="red">获取虚拟目录（常用）</font>： /demo</p>
<p>​        <strong>String   getContextPath()</strong></p>
</li>
<li><p>获取Servlet路径: /demo2</p>
<p>​        <strong>String   getServletPath()</strong></p>
</li>
<li><p>获取get方式请求参数：name=zhangsan</p>
<p>​        <strong>String getQueryString()</strong></p>
</li>
<li><p><font color="red">获取请求URI（常用）</font>： /demo/demo2</p>
<p>​        <strong>String getRequestURI():</strong>        /demo/demo2</p>
<p>​        <strong>StringBuffer getRequestURL()  :</strong><code>http://localhost:8080/demo/demo2</code></p>
</li>
<li><p>获取协议及版本：HTTP/1.1</p>
<p>​        <strong>String getProtocol()</strong></p>
</li>
<li><p>获取客户机的IP地址：</p>
<p>​        <strong>String getRemoteAddr()</strong></p>
</li>
</ul>
<p><font color="cornflowerblue">演示案例：</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>          <span class="hljs-comment">//获取请求方式</span><br>        String method = req.getMethod();<br>        System.out.println(method);<br>         <span class="hljs-comment">// 获取虚拟目录</span><br>        String contextPath = req.getContextPath();<br>        System.out.println(contextPath);<br>        <span class="hljs-comment">// 获取Servlet路径</span><br>        String servletPath = req.getServletPath();<br>        System.out.println(servletPath);<br>        <span class="hljs-comment">// 获取get方式的请求参数</span><br>        String queryString = req.getQueryString();<br>        System.out.println(queryString);<br>        <span class="hljs-comment">// 获取URI</span><br>        String requestURI = req.getRequestURI();<br>        StringBuffer requestURL = req.getRequestURL();<br>        System.out.println(requestURI);<br>        System.out.println(requestURL);<br><br>        <span class="hljs-comment">// 获取协议版本</span><br>        String protocol = req.getProtocol();<br>        System.out.println(protocol);<br>        <span class="hljs-comment">//返回用户ip</span><br>        String remoteAddr = req.getRemoteAddr();<br>        System.out.println(remoteAddr);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">super</span>.doPost(req, resp);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>通过网址<code>localhost:8080//localhost/demo/req?name=aaa&amp;age=18</code>查看控制台</p>
<p><img src="/color-ful/img/javaee/image-20210118043641316.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210118043641316"></p>
<h4 id="10-3-2-获取请求头数据"><a href="#10-3-2-获取请求头数据" class="headerlink" title="10.3.2 获取请求头数据"></a>10.3.2 获取请求头数据</h4><ul>
<li><strong>String getHeader(String name)</strong>:通过请求头的名称获取请求头的值（常用）<ul>
<li>Enumeration<String>  getHeaderNames():获取所有的请求头名称<pre><code>    * Enumeration&lt;String&gt; 相当于迭代器，API中有说
</code></pre>
</String></li>
</ul>
</li>
</ul>
<p><strong><font color="cornflowerblue">演示案例1：获取所有请求头数据</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>         <span class="hljs-comment">//获取所有请求头名称</span><br>        Enumeration&lt;String&gt; headerNames = req.getHeaderNames();<br>        <span class="hljs-keyword">while</span> (headerNames.hasMoreElements()) &#123;<br>            <span class="hljs-comment">//获取请求头的键</span><br>            String name = headerNames.nextElement();<br>            <span class="hljs-comment">//获取请求头的值</span><br>            String value = req.getHeader(name);<br>            System.out.println(name + <span class="hljs-string">&quot;--&quot;</span> + value);<br><br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>通过网址：<code>localhost:8080//localhost/demo/req2</code></p>
<p><img src="/color-ful/img/javaee/image-20210118044651942.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210118044651942"></p>
<p><strong><font color="cornflowerblue">演示案例2：获取用户浏览器信息</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req3&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>         <span class="hljs-comment">//获取UserAgent</span><br>        String agent = req.getHeader(<span class="hljs-string">&quot;user-agent&quot;</span>);<span class="hljs-comment">//请求头的key不区分大小写</span><br>        <span class="hljs-keyword">if</span> (agent.contains(<span class="hljs-string">&quot;QQBrowser&quot;</span>)) &#123;<br>            <span class="hljs-comment">//因为我们无法处理浏览器兼容问题，所以我们用一个输出语句代替处理</span><br>            System.out.println(<span class="hljs-string">&quot;您用的是QQ浏览器&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (agent.contains(<span class="hljs-string">&quot;Firefox&quot;</span>)) &#123;<br>            System.out.println(<span class="hljs-string">&quot;您用的是火狐浏览器&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>通过不同浏览器访问servlet可以有不同的效果。</p>
<p><font color="cornflowerblue">演示案例3：获取referer</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req4&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo4</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>         <span class="hljs-comment">//获取Referer</span><br>        String referer = req.getHeader(<span class="hljs-string">&quot;referer&quot;</span>);<br>        System.out.println(referer);<br>        <span class="hljs-keyword">if</span> (referer.contains(<span class="hljs-string">&quot;/demo&quot;</span>)) &#123;<br>            System.out.println(<span class="hljs-string">&quot;播放音乐&quot;</span>);<br>            <span class="hljs-comment">//等学了response之后就可以把输出语句中的内容显示到网页中</span><br><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;滚&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><font color="red">注意：如果直接通过/demo/req4 访问这个Servlet,就相当于直接自己访问自己，referer 的值是null，所以我们需要在index.jsp中加一个超链接，控制跳转</font></p>
<p><img src="/color-ful/img/javaee/image-20210118051434930.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210118051434930"></p>
<h4 id="10-3-4-获取请求体数据"><a href="#10-3-4-获取请求体数据" class="headerlink" title="10.3.4 获取请求体数据"></a>10.3.4 获取请求体数据</h4><ul>
<li><p><strong>请求体</strong>：只有POST方式有请求体。在请求体中封装了POST请求的请求参数</p>
</li>
<li><p><strong>步骤：</strong></p>
<ol>
<li><p>获取流对象</p>
<ul>
<li><strong>BufferedReader  getReader()</strong> :  获取字符输入流，只能操作字符数据</li>
<li><strong>ServletInputStream  getInputStream()</strong> : 获取字节输入流，它可以操作所有类型数据（文件上传时讲解）</li>
</ul>
</li>
<li><p>从流中获取数据</p>
</li>
</ol>
<p><strong><font color="cornflowerblue">演示案例：</font></strong></p>
<ol>
<li><p>创建<code>regist.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>注册页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/demo/req5&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    用户名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入用户名&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    密码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入密码&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;注册&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><p>创建servlet</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req5&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo5</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">//获取请求消息体</span><br>        <span class="hljs-comment">//1. 获取字符流</span><br>        BufferedReader br = req.getReader();<br>        <span class="hljs-comment">//2.读取数据</span><br>        String line = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">while</span> ((line = br.readLine()) != <span class="hljs-keyword">null</span>) &#123;<br>            System.out.println(line);<span class="hljs-comment">//username=aaa&amp;username=aaa</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="10-3-4-其他方法"><a href="#10-3-4-其他方法" class="headerlink" title="10.3.4 其他方法"></a>10.3.4 其他方法</h4><p>这些方法是由前面基础方法衍生出来的一些通用方法，更方便使用</p>
<h5 id="1-获取请求参数对象（GET-POST都能用）"><a href="#1-获取请求参数对象（GET-POST都能用）" class="headerlink" title="1.获取请求参数对象（GET/POST都能用）"></a>1.获取请求参数对象（GET/POST都能用）</h5><ul>
<li><strong>String  getParameter(String name)</strong>: 根据参数名称获取参数值</li>
<li><strong>String[]  getParameterValues(String name)</strong>: 根据参数名称获取参数值的数组（多用于复选框）例如：hobby=java &amp;hobby=c</li>
<li><strong>Enumeration<String> getParameterNames()</String></strong>:获取所有请求的参数名称</li>
<li><strong>Map&lt;String,String[]&gt; getParameterMap()</strong>:获取所有参数的map集合</li>
</ul>
<p><strong><font color="cornflowerblue">演示案例1：</font></strong></p>
<p><strong>regist2.html</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>注册页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/demo/req6&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    用户名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入用户名&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    密码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请输入密码&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>    爱好：<br>    打游戏<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;playGame&quot;</span>&gt;</span><br>    看书<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;read&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;注册&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>ServletDemo6</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req6&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo6</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">//根据参数名获取参数值</span><br><span class="hljs-comment">/*        String username = req.getParameter(&quot;username&quot;);</span><br><span class="hljs-comment">        System.out.println(&quot;get:&quot;+username);*/</span><br>        <span class="hljs-comment">//因为方法通用，所以我们可以采取统一的处理方式</span><br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">//1根据参数名获取参数值</span><br>        String username = req.getParameter(<span class="hljs-string">&quot;username&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;post:&quot;</span>+username);<br>        System.out.println(<span class="hljs-string">&quot;***************************&quot;</span>);<br>        <span class="hljs-comment">//2根据参数名获取参数值数组</span><br>        String[] hobbies = req.getParameterValues(<span class="hljs-string">&quot;hobby&quot;</span>);<br>        <span class="hljs-keyword">for</span> (String hobby : hobbies) &#123;<br>            System.out.println(hobby);<br>        &#125;<br><br>        <span class="hljs-comment">//3获取请求中所有的参数名称</span><br>        Enumeration&lt;String&gt; parameterNames = req.getParameterNames();<br>        <span class="hljs-keyword">while</span> (parameterNames.hasMoreElements()) &#123;<br>            String name = parameterNames.nextElement();<br>            String value = req.getParameter(name);<br>            System.out.println(name + <span class="hljs-string">&quot;---&quot;</span> + value);<span class="hljs-comment">//hobby复选框，所以结果中只拿了一个值</span><br>        &#125;<br><br>        <span class="hljs-comment">//4获取所有参数的map集合</span><br>        Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();<br>        Set&lt;String&gt; keys = parameterMap.keySet();<br>        <span class="hljs-keyword">for</span> (String key : keys) &#123;<br>            <span class="hljs-comment">//获取值</span><br>            String[] values = parameterMap.get(key);<br>            <span class="hljs-keyword">for</span> (String value : values) &#123;<br>                System.out.println(key+<span class="hljs-string">&quot;---&quot;</span>+value);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><font color="red"><strong>POST中文乱码解决：</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//在获取参数前，设置req编码集</span><br>req.setCharacterEncoding(<span class="hljs-string">&quot;utf-8&quot;</span>);<br></code></pre></td></tr></table></figure>

<h5 id="2-请求转发"><a href="#2-请求转发" class="headerlink" title="2. 请求转发"></a>2. 请求转发</h5><ul>
<li><strong>概述：</strong>一种在服务器内部的资源跳转方式。</li>
</ul>
<blockquote>
<p>简单理解服务器内部的资源跳转：一个服务器中有多个Servelt,多个Servlet分工协作完成用户的一个请求，这多个Servlet间数据的交换，就是资源跳转</p>
</blockquote>
<ul>
<li><p><strong>步骤</strong>：</p>
<ol>
<li>通过request对象 获取请求转发器对象：<strong>RequestDispatcher  getRequestDispatcher(String path)</strong></li>
<li>使用转发器对象进行转发：<strong>forward(ServletRequest request, ServletResponse response)</strong></li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<p><strong>ServletDemo7</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req7&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo7</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ServletDemo7 被访问。。。&quot;</span>);<br>        <span class="hljs-comment">//请求转发:链式编程</span><br>        req.getRequestDispatcher(<span class="hljs-string">&quot;/demo/req8&quot;</span>).forward(req, resp);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>ServletDemo8</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req8&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo8</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ServletDemo8 被访问。。。&quot;</span>);<br><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>通过访问req7 跳转到req8</p>
</li>
<li><p><strong>特点</strong>：</p>
<ol>
<li>浏览器地址栏路径不发生变化</li>
<li>只能转发到当前服务器内部资源中。</li>
<li>转发是一次请求，即无论内部转发几次，调用几个Servlet使用的都是同一次请求。</li>
</ol>
</li>
</ul>
<h5 id="3-共享数据"><a href="#3-共享数据" class="headerlink" title="3. 共享数据"></a>3. 共享数据</h5><ul>
<li><p><strong>概述：</strong>多个Servlet间协作数据的共享，在学习共享数据前，我们还需要学习域对象</p>
</li>
<li><p><strong>域对象：</strong>一个有作用范围的对象，可以在范围内共享数据</p>
</li>
<li><p><strong>request域：</strong>代表一次请求的范围。它的作用范围刚好就是请求转发的范围，所以，一般用于请求转发中多个资源中共享数据。也就是我们常说的<strong>一次请求，多个资源</strong></p>
<ul>
<li>方法：<ul>
<li><strong>void setAttribute(String name,Object obj)</strong>  :  存储数据</li>
<li><strong>Object getAttitude(String name)</strong>  :  通过键获取值</li>
<li><strong>void removeAttribute(String name)</strong>   :   通过键移除键值对</li>
</ul>
</li>
</ul>
<p><font color="cornflowerblue"><strong>演示案例：使用ServletDemo7 和 ServletDemo8</strong></font></p>
<p><strong>ServletDemo7</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req7&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo7</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ServletDemo7 被访问。。。&quot;</span>);<br>        req.setAttribute(<span class="hljs-string">&quot;info&quot;</span>,<span class="hljs-string">&quot;Hello&quot;</span>);<br>        <span class="hljs-comment">//请求转发:链式编程</span><br>        req.getRequestDispatcher(<span class="hljs-string">&quot;/req8&quot;</span>).forward(req, resp);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>ServletDemo8</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/req8&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestDemo8</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ServletDemo8 被访问。。。&quot;</span>);<br>        String info = (String) req.getAttribute(<span class="hljs-string">&quot;info&quot;</span>);<br>        System.out.println(info);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>通过访问req7 跳转到req8并转发info属性</p>
</li>
</ul>
<h5 id="4-获取ServletContext对象"><a href="#4-获取ServletContext对象" class="headerlink" title="4. 获取ServletContext对象"></a>4. <font color="red">获取ServletContext对象</font></h5><ul>
<li>方法：ServletContext getServletContext()</li>
<li>后面细讲，它很重要</li>
</ul>
<h3 id="10-4-用户登录"><a href="#10-4-用户登录" class="headerlink" title="10.4 用户登录"></a>10.4 用户登录</h3><p><strong>需求：</strong></p>
<ol>
<li><p>编写login.html 登录页面</p>
<ol start="2">
<li>使用Druid数据库连接池技术，操作mysql  bookManager库中的user表</li>
<li>使用JdbcTemplate技术封装JDBC</li>
<li>登录成功后，转发到SuccessServlet并在页面输出：欢迎 XXX 回来！</li>
<li>登录失败后，转发到ErrorServlet并在页面输出：用户名或密码错误</li>
</ol>
</li>
</ol>
<p><strong>步骤：</strong></p>
<ol>
<li>创建项目，导入Druid配置文件，JdbcTemplate、Druid 、 Mysql连接驱动的jar包。创建login.html界面</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--action属性：/虚拟路径/servlet资源路径--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/book/loginServlet&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>        用户名:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        密码:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;登录&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<ol>
<li><p>创建数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE bookManager CHARSET utf8;<br><br>USE bookManager;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">USER</span>(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,<br>username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>PASSWORD <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><br>)<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">USER</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-keyword">NULL</span>,<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;admin&#x27;</span>);<br></code></pre></td></tr></table></figure></li>
<li><p>创建包 org.wdzl.pojo 在包中创建对应实体类 User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(Integer id, String username, String password)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.id = id;<br>        <span class="hljs-keyword">this</span>.username = username;<br>        <span class="hljs-keyword">this</span>.password = password;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(Integer id)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsername</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> username;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUsername</span><span class="hljs-params">(String username)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.username = username;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPassword</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> password;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPassword</span><span class="hljs-params">(String password)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.password = password;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&quot;</span> + id +<br>                <span class="hljs-string">&quot;, username=&#x27;&quot;</span> + username + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, password=&#x27;&quot;</span> + password + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>创建包 org.wdzl.dao 在包中创建操作数据库的接口</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserDao</span> </span>&#123;<br><br>    <span class="hljs-function">User <span class="hljs-title">login</span><span class="hljs-params">(User loginUser)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<ol start="5">
<li> 创建包 org.wdzl.dao.impl 在包中创建接口实现类 UserDaoImpl</li>
</ol>
<p>  <font color="red">先不做实现，第6步写完后，再回来做具体实现。实现完后，写一个测试类测试一下。确保代码正确，再继续往下写。</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wdzl.dao.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.dao.DataAccessException;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><span class="hljs-keyword">import</span> org.wdzl.dao.UserDao;<br><span class="hljs-keyword">import</span> org.wdzl.pojo.User;<br><span class="hljs-keyword">import</span> org.wdzl.utils.JDBCUtils;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDao</span> </span>&#123;<br>    <span class="hljs-comment">//声明一个JDBCTemplate对象供该类中的所有方法使用</span><br>    <span class="hljs-keyword">private</span> JdbcTemplate template = <span class="hljs-keyword">new</span> JdbcTemplate(JDBCUtils.getDataSource());<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  用户登录</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> loginUser 包含用户和密码</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> user包含的全部数据</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">login</span><span class="hljs-params">(User loginUser)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1. 编写SQL</span><br>            String sql = <span class="hljs-string">&quot;select * from user where username=? and password=?&quot;</span>;<br>            <span class="hljs-comment">//调用query方法：用户存在则代码顺序执行，用户不存在则会报错</span><br>            User user = template.queryForObject(<br>                    sql,<br>                    <span class="hljs-keyword">new</span> BeanPropertyRowMapper&lt;&gt;(User.class),<br>                    loginUser.getUsername(),<br>                    loginUser.getPassword()<br>            );<br>            <span class="hljs-comment">//返回User</span><br>            <span class="hljs-keyword">return</span> user;<br>        &#125; <span class="hljs-keyword">catch</span> (DataAccessException e) &#123;<br>            e.printStackTrace();<br>            <span class="hljs-comment">//报错就代表用户不存在，我们返回null即可</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="6">
<li>准备JDBCUtils工具类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;<br><span class="hljs-keyword">import</span> com.mysql.jdbc.Statement;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Druid连接池工具类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCUtils</span> </span>&#123;<br>    <span class="hljs-comment">//成员变量</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DataSource dataSource;<br><br>    <span class="hljs-keyword">static</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1. 加载配置文件</span><br>            Properties properties = <span class="hljs-keyword">new</span> Properties();<br>            properties.load(JDBCUtils.class.getClassLoader().getResourceAsStream(<span class="hljs-string">&quot;druid.properties&quot;</span>));<br>            <span class="hljs-comment">//2. 获取连接池对象</span><br>            dataSource = DruidDataSourceFactory.createDataSource(properties);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  获取连接对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> 连接对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">return</span> dataSource.getConnection();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  释放资源</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> stmt 执行sql的对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> conn 连接数据库的对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Statement stmt, Connection conn)</span> </span>&#123;<br>        close(stmt,conn,<span class="hljs-keyword">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  释放资源</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> stmt 执行sql的对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> conn 连接数据库的对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> rs 查询结果集对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Statement stmt, Connection conn, ResultSet rs)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (stmt != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stmt.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException throwables) &#123;<br>                throwables.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (conn != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                conn.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException throwables) &#123;<br>                throwables.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (rs != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                rs.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException throwables) &#123;<br>                throwables.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  获取连接池对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> 连接池对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DataSource <span class="hljs-title">getDataSource</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> dataSource;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="7">
<li> 测试login()方法</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoImplTest</span> </span>&#123;<br><br>    UserDaoImpl userDao = <span class="hljs-keyword">new</span> UserDaoImpl();<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//正确：则打印出用户信息，不正确则会报错</span><br>        User user = <span class="hljs-keyword">new</span> User(<span class="hljs-keyword">null</span>, <span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;admin&quot;</span>);<br>        User login = userDao.login(user);<br>        System.out.println(login);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="8">
<li>创建包 org.wdzl.servlet 在包中创建 LoginServlet</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.wdzl.dao.UserDao;<br><span class="hljs-keyword">import</span> org.wdzl.dao.impl.UserDaoImpl;<br><span class="hljs-keyword">import</span> org.wdzl.pojo.User;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@WebServlet(&quot;/loginServlet&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req,resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">//1. 设置编码集</span><br>        req.setCharacterEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>        <span class="hljs-comment">//2. 获取请求参数</span><br>        String username = req.getParameter(<span class="hljs-string">&quot;username&quot;</span>);<br>        String password = req.getParameter(<span class="hljs-string">&quot;password&quot;</span>);<br>        <span class="hljs-comment">//3.封装User对象</span><br>        User loginUser = <span class="hljs-keyword">new</span> User(<span class="hljs-keyword">null</span>, username, password);<br>        <span class="hljs-comment">//4. 调用UserDao的方法</span><br>        UserDao userDao = <span class="hljs-keyword">new</span> UserDaoImpl();<br>        User user = userDao.login(loginUser);<br>        <span class="hljs-keyword">if</span> (user != <span class="hljs-keyword">null</span>) &#123;<br>            req.setAttribute(<span class="hljs-string">&quot;user&quot;</span>,user);<br>            req.getRequestDispatcher(<span class="hljs-string">&quot;/successServlet&quot;</span>).forward(req, resp);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            req.getRequestDispatcher(<span class="hljs-string">&quot;/errorServlet&quot;</span>).forward(req, resp);<br>        &#125;<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<ol start="9">
<li><p>创建SuccessServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.wdzl.pojo.User;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@WebServlet(&quot;/successServlet&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SuccessServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">//获取user对象</span><br>        User user = (User) req.getAttribute(<span class="hljs-string">&quot;user&quot;</span>);<br>        <span class="hljs-comment">//给页面写一句话，后面讲 先照着抄</span><br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>);<br>        resp.getWriter().write(<span class="hljs-string">&quot;欢迎&quot;</span>+user.getUsername()+<span class="hljs-string">&quot;回来！！！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>创建ErrorServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@WebServlet(&quot;/errorServlet&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br><br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>);<br>        resp.getWriter().write(<span class="hljs-string">&quot;用户名或密码错误&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<p>​        封装user对象的过程是比较繁琐的，因为我们这个案例只有两个字段，如果是注册业务呢？可能有几十个字段，我们也要一步一步去写吗？</p>
<p>​        接下来我们讲解一个可以简化对象封装的工具类：BeanUtils</p>
<h3 id="10-5-BeanUtils-简化数据封装"><a href="#10-5-BeanUtils-简化数据封装" class="headerlink" title="10.5 BeanUtils 简化数据封装"></a>10.5 BeanUtils 简化数据封装</h3><p><strong><font color="cornflowerblue">使用BeanUtils简化数据封装</font></strong></p>
<p>以上一个案例的LoginServlet为例</p>
<p><img src="/color-ful/img/javaee/image-20210120232425136.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210120232425136"></p>
<p><strong>使用要求：</strong></p>
<ul>
<li>类必须被public 修饰</li>
<li>必须提供无参构造</li>
<li>成员变量必须被private修饰</li>
<li>提供公共的get/set方法</li>
</ul>
<h2 id="11-HTTP-相应消息"><a href="#11-HTTP-相应消息" class="headerlink" title="11. HTTP-相应消息"></a>11. HTTP-相应消息</h2><p>1.请求消息：客户端发送给服务器端的数据</p>
<p>数据格式：<br>2. 相应消息：服务器端相应客户端的数据</p>
<p>   数据格式：<br>             1. 相应行<br>            2. 相应头<br>           3. 相应空行<br>           4. 相应体体</p>
<h3 id="11-1-响应消息的字符串格式："><a href="#11-1-响应消息的字符串格式：" class="headerlink" title="11.1 响应消息的字符串格式："></a>11.1 响应消息的字符串格式：</h3><p>通过获取浏览器 F12 查看 格式</p>
<p><font color="cornflowerblue">图示：</font></p>
<p><img src="/color-ful/img/javaee/image-20210121021150868.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210121021150868"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java">HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK <span class="hljs-comment">//响应行</span><br><span class="hljs-comment">// ****************************** 响应头 *****************************</span><br>Bdpagetype: <span class="hljs-number">1</span><br>Bdqid: <span class="hljs-number">0x86f2f3e6001eefab</span><br>Cache-Control: <span class="hljs-keyword">private</span><br>Connection: keep-alive<br>Content-Encoding: gzip<br>Content-Type: text/html;charset=utf-<span class="hljs-number">8</span><br>Date: Wed, <span class="hljs-number">20</span> Jan <span class="hljs-number">2021</span> <span class="hljs-number">18</span>:<span class="hljs-number">07</span>:<span class="hljs-number">52</span> GMT<br>Expires: Wed, <span class="hljs-number">20</span> Jan <span class="hljs-number">2021</span> <span class="hljs-number">18</span>:<span class="hljs-number">07</span>:<span class="hljs-number">52</span> GMT<br>Server: BWS/<span class="hljs-number">1.1</span><br>Set-Cookie: BDSVRTM=<span class="hljs-number">12</span>; path=/<br>Set-Cookie: BD_HOME=<span class="hljs-number">1</span>; path=/<br>Set-Cookie: H_PS_PSSID=<span class="hljs-number">33425_33430_33344_33286_33395_33398_33334_26350</span>; path=/; domain=.baidu.com<br>Strict-Transport-Security: max-age=<span class="hljs-number">172800</span><br>Traceid: <span class="hljs-number">161116607205735506029724102714616377259</span><br>X-Ua-Compatible: IE=Edge,chrome=<span class="hljs-number">1</span><br>Transfer-Encoding: chunked<br><span class="hljs-comment">// ****************************** 响应头结束 *****************************</span><br><br><span class="hljs-comment">//响应空行</span><br><span class="hljs-comment">//响应体：就是整个页面的内容（包括：html，css,js, 及数据）</span><br></code></pre></td></tr></table></figure>

<h3 id="11-2-响应行"><a href="#11-2-响应行" class="headerlink" title="11.2 响应行"></a>11.2 响应行</h3><ol>
<li><strong>组成：</strong></li>
</ol>
<p>协议/版本   响应状态码    响应码描述</p>
<ol start="2">
<li><strong>状态码：</strong></li>
</ol>
<p>  状态码都是3位数字  服务器告诉客户端本次 请求 和 响应的状态</p>
<ul>
<li>分类<ol>
<li>1xx - 服务器接收客户端消息，但是没有接收完成。等待一段时间后，发送1xx状态码，询问客户端是否继续发送消息</li>
<li> 2xx：成功。代表码：<font color="red">200</font></li>
<li> 3xx: 重定向。资源跳转的方式。代表码：<font color="red">302-重定向  ，304-访问缓存</font></li>
</ol>
<ul>
<li>重定向：比如你要访问ServletA, A说它做不了，让你访问B，然后浏览器接收到A的相应之后，会自动的访问ServletB，就相当于你一次回车进行了两次请求。</li>
</ul>
<ol start="4">
<li> 4xx: 客户端错误。比如访问路径有问题，没有对应资源 ，就会报<font color="red">404</font>。</li>
<li> 5xx: 服务器端错误。 如果服务器代码出现异常就会报<font color="red">500</font></li>
</ol>
</li>
</ul>
<h3 id="11-3-响应头"><a href="#11-3-响应头" class="headerlink" title="11.3 响应头"></a>11.3 响应头</h3><ol>
<li><p><strong>组成：</strong></p>
<p>头名称 ：值</p>
</li>
<li><p><strong>常见响应头：</strong></p>
<ul>
<li>Content-Type：服务器告诉客户端本次响应体数据格式以及编码格式</li>
<li>Content-disposition：服务器告诉客户端以什么格式打开响应体数据。如果没有设置就使用默认值。<ol>
<li>值：<ul>
<li>in-line:默认值,在当前页面内打开</li>
<li>attachment ; filename=xxx：以附件形式打开响应体。即文件下载 filename执行下载文件名称</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="12-Response-对象"><a href="#12-Response-对象" class="headerlink" title="12. Response 对象"></a>12. Response 对象</h2><h3 id="12-1-概述"><a href="#12-1-概述" class="headerlink" title="12.1 概述"></a>12.1 概述</h3><p>  Response 对象是用来设置响应消息的</p>
<ul>
<li><p>设置响应行</p>
<ul>
<li>设置状态码：setStatus( int sc) - sc 为状态码</li>
</ul>
</li>
<li><p>设置响应头</p>
<ul>
<li>setHeader(String name , String value)</li>
</ul>
</li>
<li><p>设置响应体:</p>
<ul>
<li>步骤：<ol>
<li>获取输出流<ul>
<li>字节输出流：ServletOutputStream getOutputStream()</li>
<li>字符输出流:  PrintWriter() getWriter()</li>
</ul>
</li>
<li>使用输出流将数据输出到客户端浏览器</li>
</ol>
</li>
</ul>
<p><font color="red">我们通过下面4个小案例来讲解上述内容</font></p>
</li>
</ul>
<ol>
<li>完成重定向</li>
<li>服务器输出字符数据到浏览器</li>
<li>服务器输出字节数据到浏览器</li>
<li>验证码</li>
</ol>
<h3 id="12-2-重定向"><a href="#12-2-重定向" class="headerlink" title="12.2 重定向"></a>12.2 重定向</h3><p><font color="cornflowerblue">图解：</font></p>
<p><img src="/color-ful/img/javaee/%E9%87%8D%E5%AE%9A%E5%90%91.png" srcset="/color-ful/img/loading.gif" lazyload></p>
<p><strong>步骤：</strong></p>
<pre><code>1.  设置状态码为302
 2.  设置响应头Location
</code></pre>
<p><strong>简化操作：</strong></p>
<p>​    由于 302 和 location为固定参数，所以将重定向简化为方法：sendRedirect(“/虚拟路径/资源路径”)</p>
<p><font color="cornflowerblue"><strong>演示案例：responseDemo 通过重定向 访问 responseDemo2</strong></font></p>
<p><strong>responseDemo</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  重定向演示案例</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@WebServlet(&quot;/responseDemo&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;responseDemo 被访问&quot;</span>);<br>        <span class="hljs-comment">//设置状态码</span><br>        resp.setStatus(<span class="hljs-number">302</span>);<br>        <span class="hljs-comment">//设置响应头</span><br>        resp.setHeader(<span class="hljs-string">&quot;location&quot;</span>,<span class="hljs-string">&quot;/book/responseDemo2&quot;</span>);<br><br>        <span class="hljs-comment">//重定向简单的方法实现:因为 302 和 location是固定的。</span><br>        resp.sendRedirect(<span class="hljs-string">&quot;/book/responseDemo2&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><strong>responseDemo2</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/responseDemo2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseDemo2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;responseDemo2 被访问&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><font color="red"><strong>重定向的特点：</strong></font></p>
<ul>
<li>转发的特点：forward<ol>
<li>地址栏 路径不变</li>
<li>转发只能访问当前服务器下的资源</li>
<li>转发是一次请求 可以使用request对象共享数据</li>
</ol>
</li>
<li>重定向的特点：redirect<ol>
<li>地址栏发生变化</li>
<li>可以访问其他服务器的资源</li>
<li>重定向是两次请求，不可以使用request对象共享数据</li>
</ol>
</li>
<li>面试题： <strong>forward 和 redirect 的 区别</strong></li>
</ul>
<p><strong>路径写法：</strong></p>
<ul>
<li><p>路径分类</p>
<ul>
<li><p>相对路径：找到当前资源和目标资源之间的相对位置关系</p>
<ul>
<li><code>./</code> 开头</li>
<li><code>../</code> 表示上一级目录</li>
</ul>
</li>
<li><p>绝对路径：通过绝对路径可以确定唯一资源</p>
<ul>
<li>以  <code>/</code>开头。因为当前项目中 <code>localhost:8080/</code>虚拟路径都是统一的，所以可以省略为 <code>/</code></li>
<li>判断路径给谁用<ol>
<li>浏览器用，要加虚拟目录 。例子：重定向</li>
<li>服务器用，不用加虚拟目录。例子：转发</li>
</ol>
</li>
<li>使用request.getContextPath()动态获取项目虚拟路径，这样即便是修改项目虚拟目录，我们之前写的重定向方法也不会失效。</li>
</ul>
<p><img src="/color-ful/img/javaee/image-20210121231141215.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210121231141215"></p>
</li>
</ul>
</li>
</ul>
<h3 id="12-3-服务器输出字符数据到浏览器"><a href="#12-3-服务器输出字符数据到浏览器" class="headerlink" title="12.3 服务器输出字符数据到浏览器"></a>12.3 服务器输出字符数据到浏览器</h3><p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 响应字符数据到浏览器</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@WebServlet(&quot;/responseDemo3&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseDemo3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">//获取流</span><br>        PrintWriter writer = resp.getWriter();<br>        <span class="hljs-comment">//输出字符</span><br>       <span class="hljs-comment">// writer.write(&quot;Hello Response&quot;);</span><br>        <span class="hljs-comment">//输出html标签</span><br>        writer.write(<span class="hljs-string">&quot;&lt;h1&gt;Hello Response&lt;/h1&gt;&quot;</span>);<br>        writer.write(<span class="hljs-string">&quot;你好 response&quot;</span>);<span class="hljs-comment">//乱码</span><br>     <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><font color="cornflowerblue"><strong>演示案例2：处理中文乱码</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *   处理中文乱码</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@WebServlet(&quot;/res4&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseDemo4</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         分析：中文乱码问题</span><br><span class="hljs-comment">         qq浏览器查看网页源码：默认编码集GBK</span><br><span class="hljs-comment">         输出流通过tomcat获取。编码集应该是ISO-8859-1</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">//解决中文乱码</span><br>        <span class="hljs-comment">//1. 获取流之前设置编码集</span><br>        <span class="hljs-comment">//resp.setCharacterEncoding(&quot;GBK&quot;);</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        但是仅仅设置输出流的编码集，万一用户的编码集被修改不是默认的GBK呢？</span><br><span class="hljs-comment">        我们可以使用相应头content-type,告诉浏览器本次相应的编码格式，浏览器读取到后，就会使用相应的编码</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">//设置响应头的同时也设置了本身的编码集，所以resp.setCharacterEncoding()可以省略不写</span><br>        <span class="hljs-comment">//resp.setHeader(&quot;content-type&quot;,&quot;text/html;charset=utf-8&quot;);</span><br><br>        <span class="hljs-comment">//简单的方法设置编码</span><br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>);<br><br>        <span class="hljs-comment">//获取流</span><br>        resp.getWriter().write(<span class="hljs-string">&quot;哈哈哈哈&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<h3 id="12-4-服务器输出字节数据到浏览器"><a href="#12-4-服务器输出字节数据到浏览器" class="headerlink" title="12.4 服务器输出字节数据到浏览器"></a>12.4 服务器输出字节数据到浏览器</h3><p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *   服务器相应字节数据：</span><br><span class="hljs-comment"> *      一般这种方法我们不用在输出字符上，而是用在输出图片上，比如说验证码。</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@WebServlet(&quot;/res5&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseDemo5</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>);<br><br>        ServletOutputStream outputStream = resp.getOutputStream();<br>        outputStream.write(<span class="hljs-string">&quot;你好&quot;</span>.getBytes(<span class="hljs-string">&quot;utf-8&quot;</span>));<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="12-5-验证码"><a href="#12-5-验证码" class="headerlink" title="12.5 验证码"></a>12.5 验证码</h3><p><strong>本质：</strong>它是一张图片</p>
<p><strong>目的：</strong>提高安全性，防止恶意注册等操作。</p>
<p><strong>方式：</strong>随机生成</p>
<p>本次案例做的是比较初级的验证码：在内存中随机生成验证码</p>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<ol>
<li> 后台生成图片</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> javax.imageio.ImageIO;<br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.awt.*;<br><span class="hljs-keyword">import</span> java.awt.image.BufferedImage;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.Random;<br><br><span class="hljs-meta">@WebServlet(&quot;/code&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CheckCodeServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>       <span class="hljs-comment">//1.创建一个对象，代表内存中的一张图片（空白画布）</span><br>        <span class="hljs-keyword">int</span> width = <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">int</span> height = <span class="hljs-number">50</span>;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        new BufferedImage(参数1，参数2，参数3)</span><br><span class="hljs-comment">        参数1：宽</span><br><span class="hljs-comment">        参数2：高</span><br><span class="hljs-comment">        参数3：图片类型 -常用 BufferedImage.TYPE_INT_RGB</span><br><span class="hljs-comment">         */</span><br>        BufferedImage image = <span class="hljs-keyword">new</span> BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);<br>        <span class="hljs-comment">//2.美化图片，让它变成我们想要的样子</span><br>        <span class="hljs-comment">//2.1 填充背景色</span><br>        Graphics g = image.getGraphics();<span class="hljs-comment">//获取画笔工具</span><br>        g.setColor(Color.ORANGE);<span class="hljs-comment">//设置画笔颜色</span><br>        g.fillRect(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,width,height);<span class="hljs-comment">//填充一个矩形</span><br><br>        <span class="hljs-comment">//2.2 画边框</span><br>        g.setColor(Color.green);<span class="hljs-comment">//设置画笔颜色</span><br><span class="hljs-comment">//        g.drawRect(0, 0, 100, 50);//因为边框本身占一个像素，所以右边和下边的边框会超出</span><br>        g.drawRect(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,width-<span class="hljs-number">1</span>,height-<span class="hljs-number">1</span>);<br><br>        <span class="hljs-comment">//2.3 验证码所有可能出现的字符</span><br>        String str = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;<br>        <span class="hljs-comment">//2.4 获取随机数根据随机数取字符</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">4</span>; i++) &#123;<br>            <span class="hljs-keyword">int</span> index = <span class="hljs-keyword">new</span> Random().nextInt(str.length());<br>            <span class="hljs-keyword">char</span> ch = str.charAt(index);<br>            <span class="hljs-comment">//2.5 写验证码</span><br>            g.drawString(ch+<span class="hljs-string">&quot;&quot;</span>,width/<span class="hljs-number">5</span>*i,height/<span class="hljs-number">2</span>);<br>        &#125;<br><br>        <span class="hljs-comment">//2.6 画干扰线</span><br>        g.setColor(Color.BLUE);<br>        <span class="hljs-comment">//两点确定一条线，一条线由x,y左边的组成。一共画十条</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            <span class="hljs-keyword">int</span> x1 = <span class="hljs-keyword">new</span> Random().nextInt(width);<br>            <span class="hljs-keyword">int</span> x2 = <span class="hljs-keyword">new</span> Random().nextInt(width);<br>            <span class="hljs-keyword">int</span> y1 = <span class="hljs-keyword">new</span> Random().nextInt(height);<br>            <span class="hljs-keyword">int</span> y2 = <span class="hljs-keyword">new</span> Random().nextInt(height);<br>            g.drawLine(x1,x2,y1,y2);<br>        &#125;<br><br>        <span class="hljs-comment">//3. 将图片输出到页面展示</span><br>        ImageIO.write(image, <span class="hljs-string">&quot;jpg&quot;</span>, resp.getOutputStream());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>前端页面展示验证码，并通过单击改变验证码</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>注册页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">        <span class="hljs-built_in">window</span>.onload=<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)</span>&#123;</span><br><span class="javascript">            <span class="hljs-comment">//获取图片标签对象</span></span><br><span class="javascript">         <span class="hljs-keyword">var</span> img = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;checkCode&quot;</span>);</span><br><span class="javascript">         <span class="hljs-comment">//绑定单击时间</span></span><br><span class="javascript">            img.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">                <span class="hljs-comment">//获取时间戳，为了让浏览器不读取缓存图片</span></span><br><span class="javascript">                <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();</span><br><span class="javascript">                <span class="hljs-comment">//重新请求</span></span><br><span class="javascript">                img.src=<span class="hljs-string">&quot;/book/code?&quot;</span>+date;</span><br>            &#125;;<br>        &#125;<br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;checkCode&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/book/code&quot;</span>/&gt;</span>看不清，换一张<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>



<h2 id="13-ServletContext对象"><a href="#13-ServletContext对象" class="headerlink" title="13. ServletContext对象"></a>13. ServletContext对象</h2><h3 id="13-1-概述"><a href="#13-1-概述" class="headerlink" title="13.1 概述"></a>13.1 概述</h3><p>ServletContext 对象代表整个web应用，可以和程序的容器（服务器进行通信）。</p>
<h3 id="13-2-获取该对象"><a href="#13-2-获取该对象" class="headerlink" title="13.2 获取该对象"></a>13.2 获取该对象</h3><ol>
<li>通过Request对象获取<ul>
<li>request.getServletContext()</li>
</ul>
</li>
<li>通过HttpServlet获取(实际是他的父类实现了该方法)<ul>
<li>this.getServletContext()</li>
</ul>
</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br>@<span class="hljs-constructor">WebServlet(<span class="hljs-string">&quot;/scd&quot;</span>)</span><br>public <span class="hljs-keyword">class</span> ServletContextDemo extends HttpServlet &#123;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Get(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        this.<span class="hljs-keyword">do</span><span class="hljs-constructor">Post(<span class="hljs-params">req</span>, <span class="hljs-params">resp</span>)</span>;<br>    &#125;<br><br>    @Override<br>    protected void <span class="hljs-keyword">do</span><span class="hljs-constructor">Post(HttpServletRequest <span class="hljs-params">req</span>, HttpServletResponse <span class="hljs-params">resp</span>)</span> throws ServletException, IOException &#123;<br>        ServletContext servletContext = req.get<span class="hljs-constructor">ServletContext()</span>;<br>        ServletContext servletContext1 = this.get<span class="hljs-constructor">ServletContext()</span>;<br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(servletContext);<br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(servletContext1);<br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">System</span>.</span></span>out.println(servletContext<span class="hljs-operator"> == </span>servletContext1);<br>        <span class="hljs-comment">//两种方式获取的是一个ServletContext对象</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="13-3-功能"><a href="#13-3-功能" class="headerlink" title="13.3 功能"></a>13.3 功能</h3><h4 id="1-获取MIME类型："><a href="#1-获取MIME类型：" class="headerlink" title="1. 获取MIME类型："></a>1. 获取MIME类型：</h4><ul>
<li>MIME 类型：在互联网通信过程中定义的一种文件数据类型</li>
<li>格式：大数据类型/小数据类型  比如：text / html  , image/jpeg</li>
<li>获取：String getMimeType(String file):通过文件名（包含扩展名）获取MIME的值<ul>
<li>扩展名对应的MIME可以去tomcat — conf - web.xml中查看</li>
</ul>
</li>
</ul>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/scd2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletContextDemo2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        ServletContext servletContext = req.getServletContext();<br>        <span class="hljs-comment">//定义一个文件名</span><br>        String fileName = <span class="hljs-string">&quot;index.html&quot;</span>;<br>        <span class="hljs-comment">//获取MIME</span><br>        String mimeType = servletContext.getMimeType(fileName);<br>        System.out.println(mimeType);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="2-域对象：可以共享数据"><a href="#2-域对象：可以共享数据" class="headerlink" title="2. 域对象：可以共享数据"></a>2. 域对象：可以共享数据</h4><ul>
<li><p><strong>功能：所有域对象都有该功能</strong></p>
<ul>
<li><strong>void setAttribute(String name,Object obj)</strong>  :  存储数据</li>
<li><strong>Object getAttitude(String name)</strong>  :  通过键获取值</li>
<li><strong>void removeAttribute(String name)</strong>   :   通过键移除键值对</li>
</ul>
</li>
<li><p><strong>作用域：</strong></p>
<p>​    <font color="red">最大范围，所有用户的所有数据</font></p>
</li>
</ul>
<p><font color="cornflowerblue"><strong>演示案例：定义两个Servlet，不经过转发获取数据</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/scd3&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletContextDemo3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        ServletContext servletContext = req.getServletContext();<br>        servletContext.setAttribute(<span class="hljs-string">&quot;info&quot;</span>, <span class="hljs-string">&quot;牛逼&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/scd4&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletContextDemo4</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        ServletContext servletContext = req.getServletContext();<br>        Object info = servletContext.getAttribute(<span class="hljs-string">&quot;info&quot;</span>);<br>        System.out.println(info);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h4 id="3-获取文件的服务器真实存储路"><a href="#3-获取文件的服务器真实存储路" class="headerlink" title="3. 获取文件的服务器真实存储路"></a>3. 获取文件的服务器真实存储路</h4><p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<ol>
<li>分别在src,web,WEB-INF 下创建a.txt, b.txt , c.txt</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210122021628423.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210122021628423"></p>
<ol start="2">
<li>测试案例</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/scd6&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServletContextDemo6</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        ServletContext servletContext = req.getServletContext();<br>        <span class="hljs-comment">//获取web目录下的资源</span><br>        String realPath = servletContext.getRealPath(<span class="hljs-string">&quot;/b.txt&quot;</span>);<span class="hljs-comment">// ‘/’</span><br>        <br>        <br>        <br>        <br>        System.out.println(realPath);<br><br>        <span class="hljs-comment">//获取WEB-INF下的资源:到文件夹中找对应文件对比着写. </span><br>        realPath = servletContext.getRealPath(<span class="hljs-string">&quot;/WEB-INF/c.txt&quot;</span>);<br>        System.out.println(realPath);<br><br>        <span class="hljs-comment">//src下的文件都会被放到WEB-INF下的classes路径中</span><br>        realPath = servletContext.getRealPath(<span class="hljs-string">&quot;/WEB-INF/classes/a.txt&quot;</span>);<br>        System.out.println(realPath);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="13-4-文件下载"><a href="#13-4-文件下载" class="headerlink" title="13.4 文件下载"></a>13.4 文件下载</h3><p>​    <strong>需求：</strong></p>
<pre><code>    1. 在一个html文件中写一个超链接
      2. 点击超链接，弹出下载提示框
     - 如果超链接的 href属性直接指向图片路径，因为浏览器解析器可以解析图片，所以会直接显示图片而不是下载，但是如果src指向视频，因为浏览器无法解析视频，就会默认的弹出下载框。
                    3. 下载图片
</code></pre>
<p>  <strong>分析：</strong></p>
<p>​    需要使用响应头设置资源的打开方式，否则图片无法通过超链接下载</p>
<ul>
<li>Content-disposition ：attachment ; filename=xxx</li>
</ul>
<p><strong>步骤：</strong></p>
<ol>
<li>定义页面，编辑超链接href属性，指向Servlet, 传递资源的名称：filename</li>
<li>定义servlet<ul>
<li>获取文件名</li>
<li>指定response的响应头：<ul>
<li>Content-disposition ：attachment ; filename=xxx</li>
<li>MIME</li>
</ul>
</li>
<li>使用字节输入流加载文件进内存<ul>
<li>使用ServletContext对象获取实际路径</li>
</ul>
</li>
<li>将数据写出到response输出流</li>
</ul>
</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<ol>
<li><p>先在web路径下新建image文件夹，将图片放入该文件夹，再创建一个下载页面：download.html</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;a href=&quot;/book/image/Lucky.jpg&quot;&gt;小柯基&lt;/a&gt;<br>    &lt;a href=&quot;/book/downloadServlet?filename=Lucky.jpg&quot;&gt;小柯基&lt;/a&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure></li>
<li><p>downloadServlet</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.servlet.ServletContext;<br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.ServletOutputStream;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@WebServlet(&quot;/downloadServlet&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DownloadServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-comment">// 获取文件名称</span><br>        String filename = req.getParameter(<span class="hljs-string">&quot;filename&quot;</span>);<br>        <span class="hljs-comment">//找到文件真实路径</span><br>        ServletContext servletContext = <span class="hljs-keyword">this</span>.getServletContext();<br>        String path = servletContext.getRealPath(<span class="hljs-string">&quot;/image/&quot;</span>+filename);<br>        <span class="hljs-comment">//设置响应头</span><br>        <span class="hljs-comment">//MIME类型</span><br>        String mimeType = servletContext.getMimeType(filename);<br>        resp.setHeader(<span class="hljs-string">&quot;content-type&quot;</span>, mimeType);<br>        <span class="hljs-comment">//打开方式</span><br>        resp.setHeader(<span class="hljs-string">&quot;content-disposition&quot;</span>,<span class="hljs-string">&quot;attachment;filename=&quot;</span>+filename);<br>        <span class="hljs-comment">//获取输入输出流</span><br>        FileInputStream fis = <span class="hljs-keyword">new</span> FileInputStream(path);<br>        ServletOutputStream outputStream = resp.getOutputStream();<br>        <span class="hljs-keyword">byte</span>[] bytes = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];<br>        <span class="hljs-keyword">int</span> len = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> ((len = fis.read(bytes)) != <span class="hljs-number">0</span>) &#123;<br>            outputStream.write(bytes, <span class="hljs-number">0</span>, len);<br>        &#125;<br><br>        <span class="hljs-comment">//释放资源</span><br>        fis.close();<br><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="14-会话技术"><a href="#14-会话技术" class="headerlink" title="14. 会话技术"></a>14. 会话技术</h2><p><strong>概述:</strong></p>
<p>​    一次会话中包含多次请求和相应。并且在会话范围内可以共享数据</p>
<blockquote>
<p>会话就和谈话的过程一样，你来我往很多次问答。</p>
</blockquote>
<p><strong>功能：</strong></p>
<p>​    共享技术</p>
<p><strong>分类：</strong></p>
<pre><code>1. 客户端会话技术Cookie
 2. 服务器端会话技术：Session
</code></pre>
<h3 id="14-1-Cookie"><a href="#14-1-Cookie" class="headerlink" title="14.1 Cookie"></a>14.1 Cookie</h3><ul>
<li>概述：客户端会话技术，将数据保存到客户端</li>
<li>步骤：<ol>
<li> 创建Cookie对象，绑定参数</li>
</ol>
<ul>
<li>new Cookie(String name ,String value)</li>
</ul>
<ol start="2">
<li><p>发送Cookie对象</p>
<ul>
<li>reponse . addCookie(String name)</li>
</ul>
</li>
<li><p>获取Cookie对象，拿到对象</p>
<ul>
<li>Cookie[]  request.getCookies()</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="14-2-入门案例："><a href="#14-2-入门案例：" class="headerlink" title="14.2 入门案例："></a>14.2 入门案例：</h3><p><font color="cornflowerblue"><strong>测试案例：</strong></font></p>
<ol>
<li>CookieServlet</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-meta">@WebServlet</span>(<span class="hljs-string">&quot;/cookieServlet&quot;</span>)<br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CookieServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> void doGet(<span class="hljs-type">HttpServletRequest</span> req, <span class="hljs-type">HttpServletResponse</span> resp) <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> void doPost(<span class="hljs-type">HttpServletRequest</span> req, <span class="hljs-type">HttpServletResponse</span> resp) <span class="hljs-keyword">throws</span> <span class="hljs-type">ServletException</span>, <span class="hljs-type">IOException</span> &#123;<br>            <span class="hljs-comment">//获取cookie对象</span><br>        <span class="hljs-type">Cookie</span> cookie = <span class="hljs-keyword">new</span> <span class="hljs-type">Cookie</span>(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;hello&quot;</span>);<br>        <span class="hljs-comment">//发送cookie</span><br>        resp.addCookie(cookie);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>CookieServlet2</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.Cookie;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-meta">@WebServlet(&quot;/cookieServlet2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CookieServlet2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>            <span class="hljs-comment">//获取cookie</span><br>        Cookie[] cookies = req.getCookies();<br>        <span class="hljs-comment">//获取数据，遍历cookie</span><br>        <span class="hljs-keyword">if</span> (cookies != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">for</span> (Cookie cookie : cookies) &#123;<br>                String name = cookie.getName();<br>                String value = cookie.getValue();<br>                System.out.println(name+<span class="hljs-string">&quot;:&quot;</span>+value);<br>            &#125;<br>        &#125;<br><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>通过浏览器分别访问这两个servlet,并且读取cookie中的数据</p>
<h3 id="14-3-原理图"><a href="#14-3-原理图" class="headerlink" title="14.3 原理图"></a>14.3 原理图</h3><p><img src="/color-ful/img/javaee/image-20210122021628d423.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210123125657505"></p>
<h3 id="14-4-注意事项"><a href="#14-4-注意事项" class="headerlink" title="14.4 注意事项"></a>14.4 注意事项</h3><ol>
<li>一次发送多个cookie</li>
</ol>
<ul>
<li>创建多个cookie对象，多次调用addCookie（）方法</li>
</ul>
<ol start="2">
<li><p>Cookie在浏览器中保存多长时间</p>
<ul>
<li>默认清空下，当浏览器关闭，Cookie数据被销毁</li>
<li>持久化存储：<ul>
<li>setMaxAge（intt seconds）：<ul>
<li>seconds:<ol>
<li>正数：将Cookie数据写到硬盘文件中，持久化存储 ：second具体的数值表示文件存活的时长，以秒为单位。</li>
<li>负数：默认值</li>
<li>0：删除cookie信息，因为服务器无法直接操作用户电脑。</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Tomcat 8 版本之前，不能直接存储中文数据。 8版本之后，可以直接存储中文</p>
</li>
<li><p>Cookie的获取范围</p>
<p>一个服务器多个web项目</p>
<ul>
<li>默认情况下一个tomcat服务器中，多个web项目中的cookie是不能共享的</li>
<li>我们可以方法设置：setPath(“/“)，这样cookie就可以共享了</li>
</ul>
<p>不同tomcat服务器</p>
<ul>
<li>通过setDomain（）方法，设置相同的一级域名，那么这些一级域名相同的服务器间cookie可以共享<ul>
<li>tieba.baidu.com  baidu.com就是一级域名.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="14-5-Cookie的特点"><a href="#14-5-Cookie的特点" class="headerlink" title="14.5 Cookie的特点"></a>14.5 Cookie的特点</h3><ol>
<li>cookie存储数据在客户端浏览器不安全</li>
<li>大小有限制：单个Cookie的大小为 4KB， 同一个域名下的总cookie数 不超过 20 个</li>
</ol>
<h3 id="14-6-Cookie的作用"><a href="#14-6-Cookie的作用" class="headerlink" title="14.6 Cookie的作用"></a>14.6 Cookie的作用</h3><ol>
<li>存储少量，内容不敏感的作用</li>
<li>在不登陆的情况下，完成服务器对客户端的身份识别（主要用途）<ul>
<li>比如：用户在不登陆百度的情况下对百度页面进行的个性化设置信息，会被存储在cookie中，下次访问百度。浏览器带着cookie的信息，百度服务器就可以识别其身份，展示用户个性设置的页面</li>
</ul>
</li>
</ol>
<h3 id="14-7-练习"><a href="#14-7-练习" class="headerlink" title="14.7 练习"></a>14.7 练习</h3><p> <strong>需求：</strong>访问网站时给出上一次登录信息：如果是第一次则显示首次登录。</p>
<p><strong>分析：</strong></p>
<pre><code>1. 可以采用Cookie完成
 2. 在服务器中的Servlet判断是否有一个lastTime的cookie
  - 有：则不是第一次访问
     - 响应数据
     - 更新Cookie
 - 没有：则是第一次访问
   - 响应：欢迎您，您是首次访问
   - 添加cookie:lastTime = 当前时间戳
</code></pre>
<p><font color="cornflowerblue"><strong>代码实现：</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-meta">@WebServlet(&quot;/cookie3&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CookieServlet3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>         <span class="hljs-comment">//设置响应编码集</span><br>        resp.setContentType(<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>);<br><br>          <span class="hljs-comment">//1. 获取所有Cookie</span><br>        Cookie[] cookies = req.getCookies();<br>        <span class="hljs-keyword">boolean</span> flag = <span class="hljs-keyword">false</span>;<span class="hljs-comment">//标记是否有lastTime</span><br>        <span class="hljs-comment">//2.遍历数组</span><br>        <span class="hljs-keyword">if</span> (cookies != <span class="hljs-keyword">null</span> &amp;&amp; cookies.length &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">for</span> (Cookie cookie : cookies) &#123;<br>                <span class="hljs-comment">//3. 获取cookie名称</span><br>                String name = cookie.getName();<br>                <span class="hljs-comment">//4.判断</span><br>                <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;lastTime&quot;</span>.equals(name)) &#123;<br>                    <span class="hljs-comment">//存在，不是第一次访问</span><br>                    <span class="hljs-comment">//响应数据</span><br>                    String value = cookie.getValue();<br>                    resp.getWriter().write(<span class="hljs-string">&quot;&lt;h1&gt;您上一次访问的时间是：&quot;</span>+value+<span class="hljs-string">&quot;&lt;/h1&gt;&quot;</span>);<br>                    <span class="hljs-comment">//设置新的cookie时间</span><br>                    Date date = <span class="hljs-keyword">new</span> Date();<br>                    SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>);<br>                    String newDate = sdf.format(date);<br>                    cookie.setValue(newDate);<br>                    <span class="hljs-comment">//设置cookie存活时间</span><br>                    cookie.setMaxAge(<span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">24</span> * <span class="hljs-number">30</span>);<span class="hljs-comment">//存活一个月</span><br>                    <span class="hljs-comment">//发送cookie</span><br>                    resp.addCookie(cookie);<br>                    flag = <span class="hljs-keyword">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">//第一次访问</span><br>        <span class="hljs-keyword">if</span> (cookies == <span class="hljs-keyword">null</span> || cookies.length == <span class="hljs-number">0</span> || flag == <span class="hljs-keyword">false</span>) &#123;<br>            <span class="hljs-comment">//设置新的cookie时间</span><br>            Date date = <span class="hljs-keyword">new</span> Date();<br>            SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>);<br>            String newDate = sdf.format(date);<br>            Cookie cookie = <span class="hljs-keyword">new</span> Cookie(<span class="hljs-string">&quot;lastTime&quot;</span>,newDate);<br>            <span class="hljs-comment">//设置cookie存活时间</span><br>            cookie.setMaxAge(<span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">24</span> * <span class="hljs-number">30</span>);<span class="hljs-comment">//存活一个月</span><br>            resp.addCookie(cookie);<br>            flag = <span class="hljs-keyword">true</span>;<br><br>            resp.getWriter().write(<span class="hljs-string">&quot;&lt;h1&gt;您是第一次访问&lt;/h1&gt;&quot;</span>);<br>        &#125;<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>​        写好之后会报错，因为 时间格式中有一个空格，虽然Tomcat8 之后对于中文字符可以支持，但是对于特殊字符它还是不支持，所以我们需要将Cookie数据转化为URL编码存储，使用URL解码来解析。</p>
<p>​    <font color="red">所以：我们需要在存储数据前进行URL编码，在获取数据后进行URL解码</font></p>
<p><img src="/color-ful/img/javaee/image-20210124004826118.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210124004826118"></p>
<h2 id="15-JSP"><a href="#15-JSP" class="headerlink" title="15. JSP"></a>15. JSP</h2><h3 id="15-1-概述："><a href="#15-1-概述：" class="headerlink" title="15.1 概述："></a>15.1 概述：</h3><p>​    JSP - Java Server Page : Java 服务器端页面，该页面中可以写html标签，也可以写Java代码。可以简化动态内容书写量</p>
<p><font color="cornflowerblue">演示案例：</font></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;$Title$&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>     &lt;%<br>       System.out.println(<span class="hljs-string">&quot;Hello JSP&quot;</span>);<br>     %&gt;<br>  &lt;h1&gt;Hello JSP&lt;/h1&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>当你浏览该页面时，页面既能输出html标签，服务器中又能输出</p>
<h3 id="15-2-原理："><a href="#15-2-原理：" class="headerlink" title="15.2 原理："></a>15.2 原理：</h3><p>​        JSP页面本质是一个Servlet</p>
<blockquote>
<p>因为，能在web服务器运行的java程序肯定是Servlet。我们通过前面的案例也能体会到如果我们通过Servlet的response对象响应静态资源工作量非常大的。所以将动态资源和静态资源统一定义在JSP中，服务器启动后，会将JSP转换成对应的Servlet的class字节码文件。里面的方法就是处理动态资源 和 对静态内容的输出</p>
</blockquote>
<h3 id="15-3-脚本："><a href="#15-3-脚本：" class="headerlink" title="15.3 脚本："></a>15.3 脚本：</h3><p>​    就是定义了JSP中Java代码的书写方式</p>
<ol>
<li><code>&lt;% 代码%&gt;</code>: 定义的java代码，相当于定义在Servlet中的service()方法中</li>
<li><code>&lt;%! 代码%&gt;</code>：定义的Java代码，相当于定义在Servlet中的成员位置，即成员变量和成员方法</li>
<li><code>&lt;%= 代码%&gt;</code>：输出语句，使用JSP的内置对象 Out（后面讲）</li>
</ol>
<p><strong><font color="cornflowerblue">演示案例：</font></strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;$Title$&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>     &lt;%<br>       System.out.println(<span class="hljs-string">&quot;Hello JSP&quot;</span>);<br>     %&gt;<br>      <br>     &lt;%! <span class="hljs-keyword">int</span> i = <span class="hljs-number">10</span>;%&gt;<br>     &lt;% i = <span class="hljs-number">3</span>; %&gt;<br>     &lt;%= i%&gt;<br>  &lt;h1&gt;Hello JSP&lt;/h1&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>效果：</p>
<p><img src="/color-ful/img/javaee/image-20210124012418635.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210124012418635"></p>
<h3 id="15-4-内置对象："><a href="#15-4-内置对象：" class="headerlink" title="15.4 内置对象："></a>15.4 内置对象：</h3><ol>
<li><p><strong>概述：</strong>直接在JSP页面中，不需要获取和创建，可以直接使用的对象</p>
</li>
<li><p><strong>分类</strong>：九大内置对象</p>
<ul>
<li><strong>request</strong></li>
<li><strong>response</strong></li>
<li><strong>session</strong></li>
<li><strong>out</strong></li>
<li><strong>page</strong></li>
<li><strong>application</strong></li>
<li><strong>pageContext</strong></li>
<li><strong>config</strong></li>
<li><strong>exception</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="center">内置对象名</th>
<th align="center">真实数据类型</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>request</strong></td>
<td align="center"><strong>HttpServletRequest</strong></td>
<td><strong>一次请求中共享数据</strong></td>
</tr>
<tr>
<td align="center"><strong>response</strong></td>
<td align="center"><strong>HttpServletResponse</strong></td>
<td><strong>响应对象</strong></td>
</tr>
<tr>
<td align="center"><strong>session</strong></td>
<td align="center"><strong>HttpSession</strong></td>
<td><strong>一次会话中共享数据</strong></td>
</tr>
<tr>
<td align="center"><strong>out</strong></td>
<td align="center"><strong>JspWriter</strong></td>
<td><strong>输出对象，输出数据到当前页面</strong></td>
</tr>
<tr>
<td align="center"><strong>page</strong></td>
<td align="center"><strong>Objcet(this-当前jsp页面)</strong></td>
<td><strong>当前页面的对象</strong></td>
</tr>
<tr>
<td align="center"><strong>application</strong></td>
<td align="center"><strong>ServletContext</strong></td>
<td><strong>所有用户间共享数据</strong></td>
</tr>
<tr>
<td align="center"><strong>pageContext</strong></td>
<td align="center"><strong>PageContext</strong></td>
<td><strong>当前页面共享数据，还可以获取其他8个内置对像</strong></td>
</tr>
<tr>
<td align="center"><strong>config</strong></td>
<td align="center"><strong>ServletConfig</strong></td>
<td><strong>Servlet配置对象</strong></td>
</tr>
<tr>
<td align="center"><strong>exception</strong></td>
<td align="center"><strong>Throwable</strong></td>
<td><strong>只有异常页面有该对象</strong></td>
</tr>
</tbody></table>
</li>
<li></li>
<li><p> <strong>response.getWriter()  和  out对象输出</strong>：由于web服务器的工作机制，对于页面的输出，服务器都会先访问response缓冲区，再访问out缓冲区，所以无论 response.getWriter()的编写位置在哪里，它都会先与out对象的输出。</p>
</li>
</ol>
<h3 id="15-5-Session"><a href="#15-5-Session" class="headerlink" title="15.5 Session"></a>15.5 Session</h3><ol>
<li><p><strong>概念</strong>:服务器端会话技术 - HttpSession</p>
</li>
<li><p><strong>功能</strong>：</p>
<ul>
<li>获取HttpSession对象<ul>
<li>request.getSession()</li>
</ul>
</li>
<li>使用HttpSession对象：<ul>
<li>Object getAttribute(String name)</li>
<li>void setAttribute(String name Object value)</li>
<li>void removeAttribute(String name)</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>原理：</strong></p>
<p>​    <font color="red">session的实现时依赖于cookie的。</font></p>
<p>​        第一次发送请求，服务器会创建Session对象，并设置一个唯一的ID属性，并在相应时将该Session对象的的ID 存入响应头：set-cookie : JSESSIONID= id属性。</p>
<p>​        当客户端发送第二次请求时，cookie中就会有对应的Session id , web服务器读取到头信息后，就会将两次会话中使用的Session对象指向同一个session对象。</p>
</li>
<li><p><strong>注意</strong>：</p>
<ol>
<li><p>客户端关闭后，再次开启客户端获取的Sesion是同一个吗？</p>
<ul>
<li>默认情况下不是，因为客户端关闭，cookie会被清空</li>
<li>如果需要相同，可以通过设置cookie</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebServlet(&quot;/session1&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SessionDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>        <span class="hljs-keyword">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>         <span class="hljs-comment">//获取session对象</span><br>        HttpSession session = req.getSession();<br>        <span class="hljs-comment">//System.out.println(session);//没有设置cookie存活时间前，session不是同一个</span><br>        <span class="hljs-comment">//设置cookie存活时长</span><br>        Cookie cookie = <span class="hljs-keyword">new</span> Cookie(<span class="hljs-string">&quot;JSESSIONID&quot;</span>, session.getId());<br>        cookie.setMaxAge(<span class="hljs-number">60</span> * <span class="hljs-number">60</span>);<br>        resp.addCookie(cookie);<br>        System.out.println(session);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li> 服务器重新启动后，两个会话的Sesion是同一个吗？</li>
</ol>
<ul>
<li><p>因为Session 对象会被清空，所以很难相同。但是我们不能因为重启服务器而丢失Session数据</p>
<ul>
<li>解决：Session的钝化 和 活化<ol>
<li>钝化：就是将Seession对象序列化到磁盘上</li>
<li>活化：在服务器启动后，将session文件反序列化成Session对象即可。</li>
<li><strong>注意：</strong>Tomcat可以自动完成Session的活化和钝化，但是Idea无法演示出效果，因为idea重启服务器会先将work目录删除，再重新创建。而钝化的session文件就是在work目录中</li>
</ol>
</li>
</ul>
<ol start="3">
<li>Session的什么时候销毁</li>
</ol>
</li>
<li><p>服务器关闭</p>
</li>
<li><p>session对象调用invalidate():将自己杀死</p>
</li>
<li><p>session默认失效时间：30分钟</p>
<ul>
<li>可以通过tomcat — &gt; conf —-&gt;web.xml配置失效时间</li>
<li><img src="/color-ful/C:/Users\30526\AppData\Roaming\Typora\typora-user-images\image-20210124024029769.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210124024029769"></li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>特点：</strong></p>
<ul>
<li>session 用于存储一次会话中多次请求的数据，存储在服务器端</li>
<li>session可以存储任意类型，任意大小的数据</li>
</ul>
</li>
<li><p>Session 与 cookie的区别</p>
<ul>
<li>session存储在服务器端，cookie存储在客户端</li>
<li>session没有数据大小的限制，Cookie有</li>
<li>session数据安全，cookie相对不安全</li>
</ul>
</li>
</ol>
<h3 id="15-6-登录案例优化"><a href="#15-6-登录案例优化" class="headerlink" title="15.6 登录案例优化"></a>15.6 登录案例优化</h3><ol>
<li> 将验证码实际内容存储到session对象中进行共享</li>
<li>将错误提示信息显示在对应标签后部</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210124031848431.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210124031848431"></p>
<ol start="3">
<li> 将验证码设置为一次性验证码</li>
</ol>
<h3 id="15-7-JSP指令"><a href="#15-7-JSP指令" class="headerlink" title="15.7 JSP指令"></a>15.7 JSP指令</h3><ol>
<li><strong>作用：</strong>用于配置JSP页面，导入资源文件</li>
<li><strong>格式：</strong>&lt;%@ 指令名称 属性名1=属性值1  属性名1=属性值1 %&gt;</li>
<li><strong>分类：</strong><ul>
<li>page：配置JSP页面</li>
<li>include：页面包含。（基本不用）</li>
<li>taglib：导入资源，后面使用的JSTL标签就需要使用该指令导入</li>
</ul>
</li>
</ol>
<h3 id="15-6-page指令"><a href="#15-6-page指令" class="headerlink" title="15.6 page指令"></a>15.6 page指令</h3><ol>
<li>常见属性：<ul>
<li><strong>contentType</strong>:等同于response.setContentType()：设置响应体的Mime类型及编码集。并且可以设置当前JSP的编码集（高级开发工具才有的功能）</li>
<li><strong>pageEncoding</strong>: 当前页面的编码集</li>
<li><strong>language</strong>:jsp语言，当年想统一所有表现层语言，结果没实现，所以现在的language只有 java这个属性值。</li>
<li><strong>buffer</strong>:缓冲区大小，因为jsp中使用输出流，需要缓冲区</li>
<li><strong>import</strong> ：导包，高级开发工具会自动导包</li>
<li><strong>errorPage:</strong> 当前页面如果报错，会自动跳转至该属性配置的页面。<ul>
<li>演示：在演示案例页面中写入<code>&lt;% int i = 3 /0%&gt;</code>,指定errorPage属性跳转路径，即可看到效果</li>
</ul>
</li>
<li><strong>isErrorPage</strong>:标注当前页面是否是错误页面，如果为 true， 则可以使用 Exception这个内置对象</li>
</ul>
</li>
</ol>
<h3 id="15-7-taglib"><a href="#15-7-taglib" class="headerlink" title="15.7 taglib"></a>15.7 taglib</h3><p> 我们常用于引入标签库，后面学习JSTL会用到</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ taglib prefix=<span class="hljs-string">&quot;c&quot;</span> uri=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>prefix : 前缀，自定义</li>
</ul>
<h3 id="15-8-mvc开发模式"><a href="#15-8-mvc开发模式" class="headerlink" title="15.8 mvc开发模式"></a>15.8 mvc开发模式</h3><p>​        早期还没有jsp时，都是使用servlet开发，只能使用response输出标签数据，工作量非常大。后来jsp出现后，简化了 servlet的开发，开发人员开始过度的使用jsp，导致前后端无法分离，并且代码结构混乱，阅读性非常差。为了解决这写问题 后来的java开发就借鉴了MVC开发模式，具体的规定了什么代码写什么位置，使得程序设计更加合理。</p>
<ol>
<li><strong>MVC</strong></li>
</ol>
<ul>
<li><p>M - Model 模型  <font color="limegreen">JavaBean</font></p>
<ul>
<li>完成具体的业务操作：比如：查询数据库，封装对象等。</li>
</ul>
</li>
<li><p> V - View 视图层  <font color="limegreen">JSP</font></p>
</li>
<li><p>展示数据</p>
</li>
<li><p>C - Controller 控制器  <font color="limegreen">Servlet</font></p>
<ul>
<li>获取用户的输入（请求）</li>
<li>调用模型</li>
<li>将数据交给视图层展示</li>
</ul>
</li>
</ul>
<p><img src="/color-ful/img/javaee/mvc%E5%9B%BE%E7%A4%BA.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210124043647608"></p>
<ol start="2">
<li> <strong>优点</strong></li>
</ol>
<ul>
<li>耦合性低：将代码分为三部分，各司其职，便于维护，</li>
<li>重用性高：</li>
</ul>
<ol start="3">
<li><strong>缺点</strong><ul>
<li>使得架构变复杂，对程序员要求比较高。</li>
</ul>
</li>
</ol>
<p>因为三部分各司其职，所以JSP页面仅仅做展示，所以我们需要学习替换他的两外两个技术 EL表达式 和 JSTL标签。</p>
<h2 id="16-EL表达式"><a href="#16-EL表达式" class="headerlink" title="16 EL表达式"></a>16 EL表达式</h2><h3 id="16-1-概述"><a href="#16-1-概述" class="headerlink" title="16.1 概述"></a>16.1 概述</h3><p>EL - EXpression Language 表达式语言，jsp本使支持EL表达式</p>
<h3 id="16-2-作用"><a href="#16-2-作用" class="headerlink" title="16.2 作用"></a>16.2 作用</h3><p>替换 和 简化 jsp页面中java代码的编写</p>
<h3 id="16-3-语法"><a href="#16-3-语法" class="headerlink" title="16.3 语法"></a>16.3 语法</h3><p>${  表达式 }</p>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jsp">$&#123; <span class="hljs-number">3</span>&gt;<span class="hljs-number">4</span>&#125;<br>结果：页面会直接输出运算结果<br><br>\$&#123;表达式&#125;<br>结果：他会原样输出<br></code></pre></td></tr></table></figure>



<h3 id="16-4-使用"><a href="#16-4-使用" class="headerlink" title="16.4 使用"></a>16.4 使用</h3><ol>
<li> <strong>运算</strong></li>
</ol>
<ul>
<li>算数运算：+，- ，*，/ ，%</li>
<li>比较运算：&gt;  ,&lt;  ,  &gt;=  ,  &lt; =  , &gt;= , == ,!=</li>
<li>逻辑运算：&amp;&amp; (and) ,  ||(or) , ! (非)</li>
<li>空运算符：empty 用于判断 字符串，集合 数组对象是否为null 并且长度是否为0</li>
</ul>
   <figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;h3&gt;算数运算符&lt;/h3&gt;<br>$&#123;<span class="hljs-number">1</span>+<span class="hljs-number">2</span> &#125;&lt;br&gt;<br>$&#123;<span class="hljs-number">1</span>-<span class="hljs-number">2</span> &#125;&lt;br&gt;<br>$&#123;<span class="hljs-number">1</span>*<span class="hljs-number">2</span> &#125;&lt;br&gt;<br>$&#123;<span class="hljs-number">1</span>/<span class="hljs-number">2</span> &#125;&lt;br&gt;<br>$&#123;<span class="hljs-number">1</span>%<span class="hljs-number">2</span> &#125;&lt;br&gt;<br><br>&lt;h3&gt;逻辑运算符&lt;/h3&gt;<br>$&#123; <span class="hljs-number">3</span>&gt;<span class="hljs-number">4</span> &amp;&amp; <span class="hljs-number">5</span>&lt;<span class="hljs-number">6</span>&#125;<br>$&#123; <span class="hljs-number">3</span>&gt;<span class="hljs-number">4</span> and <span class="hljs-number">5</span>&lt;<span class="hljs-number">6</span>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li><p><strong>获取值</strong></p>
<ul>
<li>EL表达式只能从域对象中获取值</li>
<li>语法：${域名称. 键名} 从指定域中获取指定键的值<ul>
<li>域名称：<ol>
<li>pageScope   —&gt;pageContext</li>
<li>requestScope —&gt; requestScope</li>
<li>sessionScope —&gt;session</li>
<li>applicationScope —&gt;application</li>
</ol>
</li>
<li>举例：取出request域中的 name属性值：${request.name}</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong><font color="cornflowerblue">演示案例1：</font></strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%<br>    request.setAttribute(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;刘德华&quot;</span>);<br>%&gt;<br>$&#123;requestScope.name&#125;<br>$&#123;requestScope.age&#125; 读不出数据也不会显示<span class="hljs-keyword">null</span>，而是显示空格<br></code></pre></td></tr></table></figure>

<p><strong><font color="cornflowerblue">演示案例2：</font></strong></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%<br>    request.setAttribute(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;刘德华&quot;</span>);<br>    session.setAttribute(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;周杰伦&quot;</span>)<br>%&gt;<br>$&#123;name&#125;<br></code></pre></td></tr></table></figure>

<p><font color="red">语法2：${ 键名} :默认会从最小的域以此向上寻找</font></p>
<h3 id="16-5-获取对象-和-集合"><a href="#16-5-获取对象-和-集合" class="headerlink" title="16.5 获取对象 和 集合"></a>16.5 获取对象 和 集合</h3><ol>
<li>user类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.domain;<br><br><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;<br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br>    <span class="hljs-keyword">private</span> Date birthday;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(String name, <span class="hljs-keyword">int</span> age, Date birthday)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>        <span class="hljs-keyword">this</span>.birthday = birthday;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 逻辑视图</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getBirStr</span><span class="hljs-params">()</span></span>&#123;<br><br>        <span class="hljs-keyword">if</span>(birthday != <span class="hljs-keyword">null</span>)&#123;<br>            <span class="hljs-comment">//1.格式化日期对象</span><br>            SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>            <span class="hljs-comment">//2.返回字符串即可</span><br>            <span class="hljs-keyword">return</span> sdf.format(birthday);<br><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getBirthday</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> birthday;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBirthday</span><span class="hljs-params">(Date birthday)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.birthday = birthday;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<p>演示案例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;el获取数据&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>    &lt;%<br>        User user = <span class="hljs-keyword">new</span> User();<br>        user.setName(<span class="hljs-string">&quot;张三&quot;</span>);<br>        user.setAge(<span class="hljs-number">23</span>);<br>        user.setBirthday(<span class="hljs-keyword">new</span> Date());<br><br><br>        request.setAttribute(<span class="hljs-string">&quot;u&quot;</span>,user);<br><br><br>        List list = <span class="hljs-keyword">new</span> ArrayList();<br>        list.add(<span class="hljs-string">&quot;aaa&quot;</span>);<br>        list.add(<span class="hljs-string">&quot;bbb&quot;</span>);<br>        list.add(user);<br><br>        request.setAttribute(<span class="hljs-string">&quot;list&quot;</span>,list);<br><br><br>        Map map = <span class="hljs-keyword">new</span> HashMap();<br>        map.put(<span class="hljs-string">&quot;sname&quot;</span>,<span class="hljs-string">&quot;李四&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;gender&quot;</span>,<span class="hljs-string">&quot;男&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;user&quot;</span>,user);<br><br>        request.setAttribute(<span class="hljs-string">&quot;map&quot;</span>,map);<br><br>    %&gt;<br><br>&lt;h3&gt;el获取对象中的值&lt;/h3&gt;<br>$&#123;requestScope.u&#125;&lt;br&gt; 这里打印的是对象的字符串表示形式<br><br>&lt;%--<br>    * 通过的是对象的属性来获取<br>        * setter或getter方法，去掉set或get，在将剩余部分，首字母变为小写。<br>        * setName --&gt; Name --&gt; name<br>--%&gt;<br><br>    $&#123;requestScope.u.name&#125;&lt;br&gt;<br>    $&#123;u.age&#125;&lt;br&gt;<br>    $&#123;u.birthday&#125;&lt;br&gt;<br>    $&#123;u.birthday.month&#125;&lt;br&gt;<span class="hljs-comment">//调用的Date类中的getMonth方法</span><br>	<br>    <span class="hljs-comment">//如果我们想获取到格式化后的日期，我们可以去user类中提供一个方法getBirStr()(下面定义)</span><br>    $&#123;u.birStr&#125;&lt;br&gt;<br><br>    &lt;h3&gt;el获取List值&lt;/h3&gt;<br>    $&#123;list&#125;&lt;br&gt;<br>    $&#123;list[<span class="hljs-number">0</span>]&#125;&lt;br&gt;<br>    $&#123;list[<span class="hljs-number">1</span>]&#125;&lt;br&gt;<br>    $&#123;list[<span class="hljs-number">10</span>]&#125;&lt;br&gt;<span class="hljs-comment">//越界 不会报错，显示空</span><br><br>    $&#123;list[<span class="hljs-number">2</span>].name&#125;<br><br>    &lt;h3&gt;el获取Map值&lt;/h3&gt;<br>    $&#123;map.gender&#125;&lt;br&gt;<br>    $&#123;map[<span class="hljs-string">&quot;gender&quot;</span>]&#125;&lt;br&gt;<br>    $&#123;map.user.name&#125;<br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>



<h3 id="16-6-隐式对象"><a href="#16-6-隐式对象" class="headerlink" title="16.6 隐式对象"></a>16.6 隐式对象</h3><p><strong>概述：</strong>el表达式中直接可以使用的对象，</p>
<p>只需要知道通过pageContext对象可以获取其他8个jsp内置对象</p>
<p>常用的是获取request对象,再获取项目的虚拟目录</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jsp">$&#123;pageContext.request&#125;&lt;br&gt;<br>&lt;h4&gt;在jsp页面动态获取虚拟目录&lt;/h4&gt;<br>$&#123;pageContext.request.contextPath&#125;<br></code></pre></td></tr></table></figure>



<h2 id="17-JSTL-标签"><a href="#17-JSTL-标签" class="headerlink" title="17. JSTL 标签"></a>17. JSTL 标签</h2><h3 id="17-1-概述："><a href="#17-1-概述：" class="headerlink" title="17.1  概述："></a>17.1  概述：</h3><p>JavaServer Pages Tag Library  JSP标准标签库 ，用于简化和替换jsp页面上的java代码</p>
<h3 id="17-2-使用"><a href="#17-2-使用" class="headerlink" title="17.2 使用"></a>17.2 使用</h3><ol>
<li>导入jstl相关jar包</li>
<li>引入标签库：taglib指令：  &lt;%@ taglib %&gt;</li>
<li>使用标签</li>
</ol>
<h3 id="17-3-if"><a href="#17-3-if" class="headerlink" title="17.3 if"></a>17.3 if</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">&quot;java.util.List&quot;</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">&quot;java.util.ArrayList&quot;</span> %&gt;<br>&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;%@ taglib prefix=<span class="hljs-string">&quot;c&quot;</span> uri=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;<br><br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;if标签&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>    &lt;%--<br><br>    c:<span class="hljs-keyword">if</span>标签<br>        <span class="hljs-number">1.</span> 属性：<br>            * test 必须属性，接受<span class="hljs-keyword">boolean</span>表达式<br>                * 如果表达式为<span class="hljs-keyword">true</span>，则显示<span class="hljs-keyword">if</span>标签体内容，如果为<span class="hljs-keyword">false</span>，则不显示标签体内容<br>                * 一般情况下，test属性值会结合el表达式一起使用<br><br>        <span class="hljs-number">2.</span> 注意：c:<span class="hljs-keyword">if</span>标签没有<span class="hljs-keyword">else</span>情况，想要<span class="hljs-keyword">else</span>情况，则可以在定义一个c:<span class="hljs-keyword">if</span>标签<br><br><br>    --%&gt;<br><br>    &lt;c:<span class="hljs-keyword">if</span> test=<span class="hljs-string">&quot;true&quot;</span>&gt;<br>        &lt;h1&gt;我是真...&lt;/h1&gt;<br>    &lt;/c:if&gt;<br>    &lt;br&gt;<br><br>    &lt;%<br>        <span class="hljs-comment">//判断request域中的一个list集合是否为空，如果不为null则显示遍历集合</span><br><br>        List list = <span class="hljs-keyword">new</span> ArrayList();<br>        list.add(<span class="hljs-string">&quot;aaaa&quot;</span>);<br>        request.setAttribute(<span class="hljs-string">&quot;list&quot;</span>,list);<br>		<br>		<span class="hljs-comment">//判断number的奇偶性</span><br>        request.setAttribute(<span class="hljs-string">&quot;number&quot;</span>,<span class="hljs-number">4</span>);<br><br>    %&gt;<br><br>    &lt;c:<span class="hljs-keyword">if</span> test=<span class="hljs-string">&quot;$&#123;not empty list&#125;&quot;</span>&gt;<br>        遍历集合...<br><br>    &lt;/c:if&gt;<br>    &lt;br&gt;<br><br>    &lt;c:<span class="hljs-keyword">if</span> test=<span class="hljs-string">&quot;$&#123;number % 2 != 0&#125;&quot;</span>&gt;<br><br>            $&#123;number&#125;为奇数<br><br>    &lt;/c:if&gt;<br><br>    &lt;c:<span class="hljs-keyword">if</span> test=<span class="hljs-string">&quot;$&#123;number % 2 == 0&#125;&quot;</span>&gt;<br><br>        $&#123;number&#125;为偶数<br><br>    &lt;/c:if&gt;<br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>



<h3 id="17-4-choose"><a href="#17-4-choose" class="headerlink" title="17.4 choose"></a>17.4 choose</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;choose标签&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>    &lt;%--<br>        完成数字编号对应星期几案例<br>            <span class="hljs-number">1.</span>域中存储一数字<br>            <span class="hljs-number">2.</span>使用choose标签取出数字         相当于<span class="hljs-keyword">switch</span>声明<br>            <span class="hljs-number">3.</span>使用when标签做数字判断         相当于<span class="hljs-keyword">case</span><br>            <span class="hljs-number">4.</span>otherwise标签做其他情况的声明  相当于<span class="hljs-keyword">default</span><br>    --%&gt;<br><br>    &lt;%<br>        request.setAttribute(<span class="hljs-string">&quot;number&quot;</span>,<span class="hljs-number">51</span>);<br>    %&gt;<br><br>    &lt;c:choose&gt;<br>        &lt;c:when test=&quot;$&#123;number == 1&#125;&quot;&gt;星期一&lt;/c:when&gt;<br>        &lt;c:when test=&quot;$&#123;number == 2&#125;&quot;&gt;星期二&lt;/c:when&gt;<br>        &lt;c:when test=&quot;$&#123;number == 3&#125;&quot;&gt;星期三&lt;/c:when&gt;<br>        &lt;c:when test=&quot;$&#123;number == 4&#125;&quot;&gt;星期四&lt;/c:when&gt;<br>        &lt;c:when test=&quot;$&#123;number == 5&#125;&quot;&gt;星期五&lt;/c:when&gt;<br>        &lt;c:when test=&quot;$&#123;number == 6&#125;&quot;&gt;星期六&lt;/c:when&gt;<br>        &lt;c:when test=&quot;$&#123;number == 7&#125;&quot;&gt;星期天&lt;/c:when&gt;<br><br>        &lt;c:otherwise&gt;数字输入有误&lt;/c:otherwise&gt;<br>    &lt;/c:choose&gt;<br><br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>



<h3 id="17-5-foreach"><a href="#17-5-foreach" class="headerlink" title="17.5 foreach"></a>17.5 foreach</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">&quot;java.util.ArrayList&quot;</span> %&gt;<br>&lt;%@ page <span class="hljs-keyword">import</span>=<span class="hljs-string">&quot;java.util.List&quot;</span> %&gt;<br>&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br><br>&lt;%<span class="hljs-meta">@taglib</span> prefix=<span class="hljs-string">&quot;c&quot;</span> uri=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;<br><br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;foreach标签&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>&lt;%--<br><br>    foreach:相当于java代码的<span class="hljs-keyword">for</span>语句<br>        <span class="hljs-number">1.</span> 完成重复的操作<br>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i ++)&#123;<br><br>            &#125;<br>            * 属性：<br>                begin：开始值（包含）<br>                end：结束值（包含）<br>                <span class="hljs-keyword">var</span>：临时变量 - 相当于i<br>                step：步长，每次改变量<br>                varStatus:循环状态对象，在普通<span class="hljs-keyword">for</span>循环中 与 <span class="hljs-keyword">var</span> 相同<br>                    index:容器中元素的索引，从<span class="hljs-number">0</span>开始<br>                    count:循环次数，从<span class="hljs-number">1</span>开始<br>        <span class="hljs-number">2.</span> 遍历容器<br>            List&lt;User&gt; list;<br>            <span class="hljs-keyword">for</span>(User user : list)&#123;<br><br>            &#125;<br><br>            * 属性：<br>                items:容器对象-list 集合<br>                <span class="hljs-keyword">var</span>:容器中元素的临时变量 - 遍历操作中存储集合元素的临时变量<br>                varStatus:循环状态对象- 循环第几次<br>                    index:容器中元素的索引，从<span class="hljs-number">0</span>开始<br>                    count:循环次数，从<span class="hljs-number">1</span>开始<br><br><br>--%&gt;<br><span class="hljs-comment">//打印1-10的基数</span><br>&lt;c:forEach begin=<span class="hljs-string">&quot;1&quot;</span> end=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-keyword">var</span>=<span class="hljs-string">&quot;i&quot;</span> step=<span class="hljs-string">&quot;2&quot;</span> varStatus=<span class="hljs-string">&quot;s&quot;</span>&gt;<br>    $&#123;i&#125; &lt;h3&gt;$&#123;s.index&#125;&lt;h3&gt; &lt;h4&gt; $&#123;s.count&#125; &lt;/h4&gt;&lt;br&gt;<br><br>&lt;/c:forEach&gt;<br><br>    &lt;hr&gt;<br><br><br>    &lt;%<br>        List list = <span class="hljs-keyword">new</span> ArrayList();<br>        list.add(<span class="hljs-string">&quot;aaa&quot;</span>);<br>        list.add(<span class="hljs-string">&quot;bbb&quot;</span>);<br>        list.add(<span class="hljs-string">&quot;ccc&quot;</span>);<br><br>        request.setAttribute(<span class="hljs-string">&quot;list&quot;</span>,list);<br><br><br>    %&gt;<br>	<span class="hljs-comment">//遍历集合</span><br>    &lt;c:forEach items=<span class="hljs-string">&quot;$&#123;list&#125;&quot;</span> <span class="hljs-keyword">var</span>=<span class="hljs-string">&quot;str&quot;</span> varStatus=<span class="hljs-string">&quot;s&quot;</span>&gt;<br><br>            $&#123;s.index&#125; $&#123;s.count&#125; $&#123;str&#125;&lt;br&gt;<br><br>    &lt;/c:forEach&gt;<br><br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p><strong>练习:</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;test&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>&lt;%<br><br>    List list = <span class="hljs-keyword">new</span> ArrayList();<br>    list.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;张三&quot;</span>,<span class="hljs-number">23</span>,<span class="hljs-keyword">new</span> Date()));<br>    list.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;李四&quot;</span>,<span class="hljs-number">24</span>,<span class="hljs-keyword">new</span> Date()));<br>    list.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;王五&quot;</span>,<span class="hljs-number">25</span>,<span class="hljs-keyword">new</span> Date()));<br><br>    request.setAttribute(<span class="hljs-string">&quot;list&quot;</span>,list);<br><br><br>%&gt;<br><br>&lt;table border=<span class="hljs-string">&quot;1&quot;</span> width=<span class="hljs-string">&quot;500&quot;</span> align=<span class="hljs-string">&quot;center&quot;</span>&gt;<br>    &lt;tr&gt;<br>        &lt;th&gt;编号&lt;/th&gt;<br>        &lt;th&gt;姓名&lt;/th&gt;<br>        &lt;th&gt;年龄&lt;/th&gt;<br>        &lt;th&gt;生日&lt;/th&gt;<br>    &lt;/tr&gt;<br>    &lt;%--数据行--%&gt;<br>    &lt;c:forEach items=<span class="hljs-string">&quot;$&#123;list&#125;&quot;</span> <span class="hljs-keyword">var</span>=<span class="hljs-string">&quot;user&quot;</span> varStatus=<span class="hljs-string">&quot;s&quot;</span>&gt;<br><br>        &lt;c:<span class="hljs-keyword">if</span> test=<span class="hljs-string">&quot;$&#123;s.count % 2 != 0&#125;&quot;</span>&gt;<br><br>            &lt;tr bgcolor=<span class="hljs-string">&quot;red&quot;</span>&gt;<br>                &lt;td&gt;$&#123;s.count&#125;&lt;/td&gt;<br>                &lt;td&gt;$&#123;user.name&#125;&lt;/td&gt;<br>                &lt;td&gt;$&#123;user.age&#125;&lt;/td&gt;<br>                &lt;td&gt;$&#123;user.birStr&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>        &lt;/c:if&gt;<br><br>        &lt;c:<span class="hljs-keyword">if</span> test=<span class="hljs-string">&quot;$&#123;s.count % 2 == 0&#125;&quot;</span>&gt;<br><br>            &lt;tr  bgcolor=<span class="hljs-string">&quot;green&quot;</span>&gt;<br>                &lt;td&gt;$&#123;s.count&#125;&lt;/td&gt;<br>                &lt;td&gt;$&#123;user.name&#125;&lt;/td&gt;<br>                &lt;td&gt;$&#123;user.age&#125;&lt;/td&gt;<br>                &lt;td&gt;$&#123;user.birStr&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>        &lt;/c:if&gt;<br><br>    &lt;/c:forEach&gt;<br><br>&lt;/table&gt;<br><br><br><br><br><br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>



<h2 id="18-过滤器"><a href="#18-过滤器" class="headerlink" title="18. 过滤器"></a>18. 过滤器</h2><h3 id="18-1-概述"><a href="#18-1-概述" class="headerlink" title="18.1  概述"></a>18.1  概述</h3><pre><code>   1. 概述：当访问服务器资源时，过滤器可以将请求拦截下来，进行一些特殊的功能
  2. 作用：一般用于完成通用的操作，比如登录操作，统一编码处理，过滤敏感字符
</code></pre>
<h3 id="18-2-快速入门"><a href="#18-2-快速入门" class="headerlink" title="18.2 快速入门"></a>18.2 快速入门</h3><p>​    步骤：</p>
<ol>
<li>定义一个类，实现接口Fileter</li>
<li>复写方法</li>
<li>配置拦截路径。</li>
</ol>
<p><strong><font color="cornflowerblue">演示案例</font></strong></p>
<p>创建一个类，实现Filter接口，启动服务器，如果没有放行代码，则jsp中内容将不会给展示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> lp</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@WebFilter(&quot;/*&quot;)</span><span class="hljs-comment">//访问所有资源都会被执行</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FilterDemo1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;过滤器被执行。。。。&quot;</span>);<br>        <span class="hljs-comment">//放行</span><br>        filterChain.doFilter(servletRequest,servletResponse);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<h3 id="18-3-执行流程"><a href="#18-3-执行流程" class="headerlink" title="18.3 执行流程"></a>18.3 执行流程</h3><p>通过代码来演示Filter的执行流程：</p>
<p>新建一个过滤器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebFilter(&quot;/*&quot;)</span><span class="hljs-comment">//访问所有资源都会被执行</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FilterDemo2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;过滤器被执行。。。。&quot;</span>);<br>        <span class="hljs-comment">//放行</span><br>        filterChain.doFilter(servletRequest,servletResponse);<br><br>        System.out.println(<span class="hljs-string">&quot;过滤器又被执行了。。。&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>再index.jsp中添加一条输出语句</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;title&gt;$Title$&lt;/title&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>  &lt;%<br>    System.out.println(<span class="hljs-string">&quot;JSP被执行&quot;</span>);<br>  %&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>执行结果：</p>
<p><img src="/color-ful/img/javaee/image-20210127224246497.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210127224246497"></p>
<p>​        为什么会这样呢？ 因为过滤器是对访问数据和响应数据进行处理的，所以访问前，过滤会执行一次，处理request中的对象，jsp页面执行完毕后，过滤器又会对response中的数据进行处理。</p>
<p>​      有一点需要注意的是，<font color="red">过滤器再次被执行就从 放行语句后开始执行</font></p>
<h3 id="18-4-过滤器配置：（只讲注解方式）"><a href="#18-4-过滤器配置：（只讲注解方式）" class="headerlink" title="18.4 过滤器配置：（只讲注解方式）"></a>18.4 过滤器配置：（只讲注解方式）</h3><ul>
<li>拦截路径配置：<pre><code>  1. 具体资源路径： /index.jsp   只有访问index.jsp资源时，过滤器才会被执行
</code></pre>
<ol start="2">
<li>拦截目录： /user/*    访问/user下的所有资源时，过滤器都会被执行</li>
<li>后缀名拦截： *.jsp        访问所有后缀名为jsp资源时，过滤器都会被执行</li>
<li>拦截所有资源：/*        访问所有资源时，过滤器都会被执行</li>
</ol>
</li>
<li>拦截方式配置：资源被访问的方式：直接访问，转发等<ol>
<li>注解配置：<ul>
<li>设置dispatcherTypes属性<ul>
<li>REQUEST：默认值。浏览器直接请求资源</li>
<li>FORWARD：转发访问资源</li>
<li>INCLUDE：包含访问资源</li>
<li>ERROR：错误跳转资源 ：jsp 中配置</li>
<li>ASYNC：异步访问资源</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@WebFilter(value = &quot;/index.jsp&quot;,dispatcherTypes = DispatcherType.REQUEST)</span><span class="hljs-comment">//配置一种方式</span><br><span class="hljs-meta">@WebFilter(value = &quot;/index.jsp&quot;,dispatcherTypes = &#123;DispatcherType.REQUEST,DispatcherType.FORWARD&#125;)</span><span class="hljs-comment">//配置多种访问方式被拦截</span><br></code></pre></td></tr></table></figure>

<h3 id="18-5-过滤器链"><a href="#18-5-过滤器链" class="headerlink" title="18.5 过滤器链"></a>18.5 过滤器链</h3><p>这里我们只需要了解执行顺序即可</p>
<ul>
<li>执行顺序：如果有两个过滤器：过滤器1和过滤器2<ol>
<li>过滤器1</li>
<li>过滤器2</li>
</ol>
</li>
</ul>
<ol start="3">
<li>资源执行</li>
<li>过滤器2</li>
<li>过滤器1 </li>
</ol>
<ul>
<li>过滤器先后顺序：按照类名字符串比较顺序。xml配置按照配置先后。</li>
</ul>
<h2 id="解决控制台中文乱码"><a href="#解决控制台中文乱码" class="headerlink" title="# 解决控制台中文乱码"></a># 解决控制台中文乱码</h2><p><font color="cornflowerblue">1.Tomcat 设置面板</font></p>
<p><img src="/color-ful/img/javaee/image-20210116225154221.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116225154221"></p>
<p><font color="cornflowerblue">2.Settings </font></p>
<p><img src="/color-ful/img/javaee/image-20210116225326468.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116225326468"></p>
<p><font color="cornflowerblue">3. Help — Edit Custom VM Options</font></p>
<p><img src="/color-ful/img/javaee/image-20210116225407489.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210116225407489"></p>
<p>最后一行:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">-Dfile.encoding=UTF-<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/color-ful/categories/JavaEE-%E4%BA%8C%E9%98%B6/">JavaEE 二阶</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/color-ful/tags/JSP/">JSP</a>
                    
                      <a class="hover-with-bg" href="/color-ful/tags/Servlet/">Servlet</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/color-ful/2020/01/17/4.%E4%BA%8C%E9%98%B6%E6%AE%B5%E9%A1%B9%E7%9B%AE-%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">二阶段练习项目：图书管理系统</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/color-ful/js/debouncer.js" ></script>
<script  src="/color-ful/js/events.js" ></script>
<script  src="/color-ful/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/color-ful/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/color-ful/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/color-ful/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/color-ful/js/boot.js" ></script>


</body>
</html>
