

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/color-ful/img/favicon.png">
  <link rel="icon" href="/color-ful/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="LP">
  <meta name="keywords" content="">
  
  <title>JDBC - Eureka</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/color-ful/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/color-ful/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"lpgogogo.gitee.io","root":"/color-ful/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/color-ful/js/utils.js" ></script>
  <script  src="/color-ful/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/color-ful/">&nbsp;<strong>Eureka</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/color-ful/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/color-ful/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="JDBC">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      LP
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-01-17 00:00" pubdate>
        2020年1月17日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.1k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      102
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">JDBC</h1>
            
            <div class="markdown-body">
              <h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="1-概述："><a href="#1-概述：" class="headerlink" title="1. 概述："></a>1. 概述：</h2><p>JDBC - Java DataBase Connectivity  Java数据库连接，更简单的说就是Java语言操作数据库。</p>
<p><img src="/color-ful/img/javaee/JDBC%E5%9B%BE%E8%A7%A3.png" srcset="/color-ful/img/loading.gif" lazyload></p>
<p>​        <font color="red"><strong>JDBC本质：其实是Sun公司定义的一套操作所有关系型数据库的规则，即接口，各个厂商去实现这套接口，提供数据库驱动Jar包，我们可以使用这套接口进行编程，真正执行的代码是数据库驱动中的实现类。</strong></font></p>
<p>​     其实这也是多态编程的优点：比如我调用了JDBC接口中的一个getName()方法，实际执行会根据不同的驱动，调用不同的方法。</p>
<h2 id="2-快速入门"><a href="#2-快速入门" class="headerlink" title="2. 快速入门"></a>2. 快速入门</h2><p><strong>步骤：</strong></p>
<ol>
<li>导入驱动Jar包</li>
<li> 注册驱动，让程序知道我们用的是哪个版本的驱动</li>
<li>获取数据库连接对象 Connection</li>
<li>定义SQL</li>
<li>获取执行SQL语句的对象：Statement</li>
<li>执行SQL，接收返回结果</li>
<li>处理结果</li>
<li>释放资源</li>
</ol>
<p><font color="cornflowerblue">1. 创建一个空Project</font></p>
<p><font color="cornflowerblue">2. 在空项目中添加Module</font></p>
<p><img src="/color-ful/img/javaee/image-20210119001825356.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119001825356"></p>
<p> 选择<code>Java</code>项目</p>
<p><img src="/color-ful/img/javaee/image-20210119001926720.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119001926720"></p>
<p>选择存储路径</p>
<p><img src="/color-ful/img/javaee/image-20210119001952049.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119001952049"></p>
<p><font color="cornflowerblue">3. 在项目中新建包 和 对应的快速入门演示案例类</font></p>
<p><img src="/color-ful/img/javaee/image-20210119002328874.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119002328874"></p>
<p><font color="cornflowerblue">4. 导入驱动jar包</font></p>
<p>在项目中添加一个文件夹，将驱动包复制到该包中，右键—》 add as library…</p>
<p> <img src="/color-ful/img/javaee/image-20210119002703244.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119002703244"></p>
<p>接下来就是代码部分</p>
<p><font color="cornflowerblue"><strong>演示案例</strong></font></p>
<p>数据库：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> test CHARSET utf8;<br>USE test;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> student(<br>id <span class="hljs-type">INT</span>,#学号<br><span class="hljs-type">NAME</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),#姓名<br>age <span class="hljs-type">INT</span>,#年龄<br>sex <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">5</span>),#性别<br>address <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),#地址<br>math <span class="hljs-type">INT</span>,#数学<br>english <span class="hljs-type">INT</span>#英语<br>);<br><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> student (id,<span class="hljs-type">NAME</span>,age,sex,address,math,english) <span class="hljs-keyword">VALUES</span> <br>(<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;马云&#x27;</span>,<span class="hljs-number">18</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;杭州&#x27;</span>,<span class="hljs-number">80</span>,<span class="hljs-number">80</span>),<br>(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;马化腾&#x27;</span>,<span class="hljs-number">19</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;深圳&#x27;</span>,<span class="hljs-number">75</span>,<span class="hljs-number">60</span>),<br>(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;埃隆马斯克&#x27;</span>,<span class="hljs-number">31</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;美国&#x27;</span>,<span class="hljs-number">76</span>,<span class="hljs-number">93</span>),<br>(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;扎克伯格&#x27;</span>,<span class="hljs-number">27</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;美国&#x27;</span>,<span class="hljs-number">65</span>,<span class="hljs-keyword">NULL</span>),<br>(<span class="hljs-number">5</span>,<span class="hljs-string">&#x27;郎平&#x27;</span>,<span class="hljs-number">16</span>,<span class="hljs-string">&#x27;女&#x27;</span>,<span class="hljs-string">&#x27;上海&#x27;</span>,<span class="hljs-number">90</span>,<span class="hljs-number">98</span>),<br>(<span class="hljs-number">6</span>,<span class="hljs-string">&#x27;姚明&#x27;</span>,<span class="hljs-number">32</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;上海&#x27;</span>,<span class="hljs-number">80</span>,<span class="hljs-number">81</span>);<br><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> student;<br></code></pre></td></tr></table></figure>

<p>测试案例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>         <span class="hljs-comment">//1. 注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>        <span class="hljs-comment">//2.获取数据库连接对象</span><br>        Connection connection = DriverManager.getConnection(<br>                <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>,<br>                <span class="hljs-string">&quot;root&quot;</span>,<br>                <span class="hljs-string">&quot;root&quot;</span>);<br><br>        <span class="hljs-comment">//3.定义sql语句</span><br>        String sql = <span class="hljs-string">&quot;update student set english=90 where id = 4&quot;</span>;<br>        <span class="hljs-comment">//4获取执行sql的对象</span><br>        Statement statement = connection.createStatement();<br>        <span class="hljs-comment">//5.执行sql</span><br>        <span class="hljs-keyword">int</span> count = statement.executeUpdate(sql);<br>        <span class="hljs-comment">//6.处理结果</span><br>        System.out.println(count);<br><br>        <span class="hljs-comment">//7.释放资源</span><br>        statement.close();<br>        connection.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="3-JDBC过程中的对象详解"><a href="#3-JDBC过程中的对象详解" class="headerlink" title="3. JDBC过程中的对象详解"></a>3. JDBC过程中的对象详解</h2><h3 id="3-1-Class-forName"><a href="#3-1-Class-forName" class="headerlink" title="3.1 Class.forName"></a>3.1 Class.forName</h3><p><font color="red">疑问：这行代码获取到Class对象，却又不用变量接收，这行代码有什么意义？</font></p>
<p>答：我们先去驱动包中找到Driver的源码</p>
<p><font color="cornflowerblue">源码截图</font></p>
<p><img src="/color-ful/img/javaee/image-20210119005452350.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119005452350"></p>
<p>​        JVM加载类的过程分为三步：<strong>加载，链接，初始化</strong>。</p>
<p>​        在初始化这步，会执行类构造器方法<code>clinit()</code>,而该方法是由变量的赋值动作 和 静态代码块的语句合并产生的。也就是说 <strong>类的加载器在加载指定的类的时候，如果该类结构中包含静态代码块，则会执行静态代码块中的代码</strong>。</p>
<p>​        因为JDBC的驱动有多种版本，所以JDBC规范中规定，所有驱动都必须向驱动管理器注册以区分各个版本。而<code>Driver</code>类 中只有一个无参构造 和 一个静态代码块，静态代码块中的内容 刚好就是 驱动向驱动管理器注册的代码。所以：<font color="red"><strong>Class.forName()的目的是加载Driver类的时候向驱动管理器注册自己。</strong></font></p>
<h3 id="3-2-DriverManager-驱动器管理对象"><a href="#3-2-DriverManager-驱动器管理对象" class="headerlink" title="3.2 DriverManager : 驱动器管理对象"></a>3.2 DriverManager : 驱动器管理对象</h3><p><strong>功能：</strong></p>
<ol>
<li><p>注册驱动（Class.forName()中已经解释）：MySql5之后的驱动Jar可以不注册驱动，它会自动帮我们注册。</p>
</li>
<li><p>获取数据库连接对象：</p>
<ul>
<li><p>方法：</p>
<p><strong>DriverManager.getConnection(“URL”, “用户名”, “密码”);</strong></p>
</li>
<li><p>参数：</p>
<ul>
<li><p>url：<font color="red">jdbc : mysql : // ip地址(域名):端口号 / 数据库名称</font></p>
<ul>
<li><p>注意：如果mysql是本机数据库且端口是默认端口3306，则可以将<code>ip地址(域名):端口号</code>部分省略</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">jdbc:</span>mysql:<span class="hljs-comment">///test</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>用户名：连接mysql的用户名</p>
</li>
<li><p>密码：对应的密码</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="3-3-Connection-数据库连接对象"><a href="#3-3-Connection-数据库连接对象" class="headerlink" title="3.3 Connection : 数据库连接对象"></a>3.3 Connection : 数据库连接对象</h3><p><strong>功能：</strong></p>
<pre><code> 1. 获取执行sql的对象
 -  **Statement  createStatement()**
 - **PreparedStatement prepareStatement(String sql)**
2. 管理事务：
</code></pre>
<ul>
<li>开启事务：**void  setAutoCommit(boolean autoCommit)**：调用该方法，参数为false，即开启事务</li>
<li>提交事务：<strong>commit()</strong></li>
<li>回滚事务:  <strong>rollback()</strong></li>
</ul>
<h3 id="3-4-Statement-执行静态sql的对象"><a href="#3-4-Statement-执行静态sql的对象" class="headerlink" title="3.4 Statement : 执行静态sql的对象"></a>3.4 Statement : 执行静态sql的对象</h3><p><strong>功能：</strong></p>
<ol>
<li>执行 静态SQL 的对象<ul>
<li><strong>boolean execute(String sql)</strong> ：可以执行任意的sql （不常用）</li>
<li><strong>int executeUpdate(String sql)</strong> ：执行DML（insert、update、delete）语句、DDL(create，alter、drop)语句<ul>
<li>返回值int为影响行数可以作为语句是否执行成功的判断标准：&gt;0 成功</li>
</ul>
</li>
<li><strong>ResultSet executeQuery(String sql)</strong>  ：执行DQL（select)语句</li>
</ul>
</li>
</ol>
<p><strong>练习：</strong></p>
<p>​    <font color="cornflowerblue">1. 给student表中增加一条记录</font> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 给student表中添加一条记录</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><br>        Statement statement = <span class="hljs-keyword">null</span>;<br>        Connection connection = <span class="hljs-keyword">null</span>;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//注册驱动</span><br>            Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>            <span class="hljs-comment">//获取连接对象</span><br>           connection = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>);<br>            <span class="hljs-comment">//编写sql</span><br>            String sql = <span class="hljs-string">&quot;insert into student (id,name,age,sex,address,math,english) values(21,&#x27;呵呵&#x27;,18,&#x27;男&#x27;,&#x27;杭州&#x27;,80,80)&quot;</span>;<br>            <span class="hljs-comment">//获取执行sql的对象</span><br>            statement = connection.createStatement();<br>            <span class="hljs-comment">//执行sql</span><br>            <span class="hljs-keyword">int</span> count = statement.executeUpdate(sql);<br>            <span class="hljs-comment">//处理结果</span><br>            <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;添加成功&quot;</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                System.out.println(<span class="hljs-string">&quot;添加失败&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br><br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">if</span> (statement != <span class="hljs-keyword">null</span>) &#123;<br>                        statement.close();<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (connection != <span class="hljs-keyword">null</span>) &#123;<br>                        connection.close();<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                    se.printStackTrace();<br>                &#125;<br><br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><font color="cornflowerblue">2.修改student表中的数据<br></font></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 修改表中的数据</span><br><span class="hljs-comment"> */</span><br>public class JdbcDemo3 &#123;<br>    public static void main(String[] args) &#123;<br>        Statement statement <span class="hljs-operator">=</span> <span class="hljs-keyword">null</span>;<br>        Connection connection <span class="hljs-operator">=</span> <span class="hljs-keyword">null</span>;<br><br>        try &#123;<br>            <span class="hljs-operator">/</span><span class="hljs-operator">/</span>注册驱动<br>            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);<br>            <span class="hljs-operator">/</span><span class="hljs-operator">/</span>获取连接对象<br>            connection <span class="hljs-operator">=</span> DriverManager.getConnection(<br>                    &quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&quot;,<br>                    &quot;root&quot;,<br>                    &quot;root&quot;);<br>            <span class="hljs-operator">/</span><span class="hljs-operator">/</span>编写<span class="hljs-keyword">sql</span><br>            String <span class="hljs-keyword">sql</span> <span class="hljs-operator">=</span> &quot;update student set name =&#x27;丁磊&#x27; where id=20&quot;;<br>            <span class="hljs-operator">/</span><span class="hljs-operator">/</span>获取执行<span class="hljs-keyword">sql</span>的对象<br>            statement <span class="hljs-operator">=</span> connection.createStatement();<br>            <span class="hljs-operator">/</span><span class="hljs-operator">/</span>执行<span class="hljs-keyword">sql</span><br>            <span class="hljs-type">int</span> count <span class="hljs-operator">=</span> statement.executeUpdate(<span class="hljs-keyword">sql</span>);<br>            <span class="hljs-operator">/</span><span class="hljs-operator">/</span>处理结果<br>            if (count &gt; 0) &#123;<br>                System.out.println(&quot;修改成功&quot;);<br>            &#125; else &#123;<br>                System.out.println(&quot;修改失败&quot;);<br>            &#125;<br>        &#125; catch (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;finally &#123;<br>            try &#123;<br>                if (statement != null) &#123;<br>                    statement.close();<br>                &#125;<br>                if (connection != null) &#123;<br>                    connection.close();<br>                &#125;<br>            &#125; catch (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<h3 id="3-5-ResultSet-结果集对象"><a href="#3-5-ResultSet-结果集对象" class="headerlink" title="3.5 ResultSet : 结果集对象"></a>3.5 ResultSet : 结果集对象</h3><p><strong>功能：</strong></p>
<ol>
<li><p><strong>next（）</strong>: 与Itrator迭代器的next（）功能类似，将游标移动到吓一条记录。 起始位置在表头位置，所以第一                次取数据需要先调用一次next（）。</p>
</li>
<li><p>**getXxx(参数)**：获取数据</p>
<ul>
<li>Xxx: 代表数据类型：比如 int getInt()</li>
<li>参数：<ul>
<li>int  :  代表列的编号，从1开始</li>
<li>String : 代表列名称：比如 getString(“name”)</li>
</ul>
</li>
</ul>
<p><font color="cornflowerblue"><strong>演示案例1：取一条记录</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 查询表中数据，并取一条记录</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo4</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Statement statement = <span class="hljs-keyword">null</span>;<br>        Connection connection = <span class="hljs-keyword">null</span>;<br>        ResultSet resultSet = <span class="hljs-keyword">null</span>;<br>        <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//注册驱动</span><br>            Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>            <span class="hljs-comment">//获取连接对象</span><br>            connection = DriverManager.getConnection(<br>                    <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&quot;</span>,<br>                    <span class="hljs-string">&quot;root&quot;</span>,<br>                    <span class="hljs-string">&quot;root&quot;</span>);<br>            <span class="hljs-comment">//编写sql</span><br>            String sql = <span class="hljs-string">&quot;select * from student&quot;</span>;<br>            <span class="hljs-comment">//获取执行sql的对象</span><br>            statement = connection.createStatement();<br>            <span class="hljs-comment">//执行sql</span><br>            resultSet = statement.executeQuery(sql);<br>            <span class="hljs-comment">//处理结果</span><br>            resultSet.next();<br>            String name = resultSet.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>            <span class="hljs-keyword">int</span> age = resultSet.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>            System.out.println(name+<span class="hljs-string">&quot;--&quot;</span>+age);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (resultSet != <span class="hljs-keyword">null</span>) &#123;<br>                    resultSet.close();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (statement != <span class="hljs-keyword">null</span>) &#123;<br>                    statement.close();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (connection != <span class="hljs-keyword">null</span>) &#123;<br>                    connection.close();<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><strong><font color="cornflowerblue">演示案例2：遍历结果集</font></strong></p>
<p>​        通过查询API，我们看到 <strong>next()方法 的返回值为是否还有下一条数据：false:没有 true:有</strong>。那么我们就可以根据next方法的返回值来作为循环的条件，对结果集进行遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 查询表中数据，遍历结果集</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo5</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Statement statement = <span class="hljs-keyword">null</span>;<br>        Connection connection = <span class="hljs-keyword">null</span>;<br>        ResultSet resultSet = <span class="hljs-keyword">null</span>;<br>        <br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//注册驱动</span><br>            Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>            <span class="hljs-comment">//获取连接对象</span><br>            connection = DriverManager.getConnection(<br>                    <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&quot;</span>,<br>                    <span class="hljs-string">&quot;root&quot;</span>,<br>                    <span class="hljs-string">&quot;root&quot;</span>);<br>            <span class="hljs-comment">//编写sql</span><br>            String sql = <span class="hljs-string">&quot;select * from student&quot;</span>;<br>            <span class="hljs-comment">//获取执行sql的对象</span><br>            statement = connection.createStatement();<br>            <span class="hljs-comment">//执行sql</span><br>            resultSet = statement.executeQuery(sql);<br>            <span class="hljs-comment">//处理结果</span><br><br>            <span class="hljs-keyword">while</span> (resultSet.next()) &#123;<br>                String name = resultSet.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>                <span class="hljs-keyword">int</span> age = resultSet.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>                System.out.println(name+<span class="hljs-string">&quot;--&quot;</span>+age);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (resultSet != <span class="hljs-keyword">null</span>) &#123;<br>                    resultSet.close();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (statement != <span class="hljs-keyword">null</span>) &#123;<br>                    statement.close();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (connection != <span class="hljs-keyword">null</span>) &#123;<br>                    connection.close();<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<p><strong><font color="cornflowerblue">演示案例3：查询Student表中所有数据，并将数据存储到集合中</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 查询Student表中数据，并将所有数据存入到集合中</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo6</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        System.out.println(findAll());<br>    &#125;<br><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Student&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>&#123;<br>        Statement statement = <span class="hljs-keyword">null</span>;<br>        Connection connection = <span class="hljs-keyword">null</span>;<br>        ResultSet resultSet = <span class="hljs-keyword">null</span>;<br>        List&lt;Student&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//注册驱动</span><br>            Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>            <span class="hljs-comment">//获取连接对象</span><br>            connection = DriverManager.getConnection(<br>                    <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&quot;</span>,<br>                    <span class="hljs-string">&quot;root&quot;</span>,<br>                    <span class="hljs-string">&quot;root&quot;</span>);<br>            <span class="hljs-comment">//编写sql</span><br>            String sql = <span class="hljs-string">&quot;select * from student&quot;</span>;<br>            <span class="hljs-comment">//获取执行sql的对象</span><br>            statement = connection.createStatement();<br>            <span class="hljs-comment">//执行sql</span><br>            resultSet = statement.executeQuery(sql);<br>            <span class="hljs-comment">//处理结果集</span><br>            <span class="hljs-keyword">while</span> (resultSet.next()) &#123;<br>                <span class="hljs-keyword">int</span> id = resultSet.getInt(<span class="hljs-string">&quot;id&quot;</span>);<br>                String name = resultSet.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>                <span class="hljs-keyword">int</span> age = resultSet.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>                String sex = resultSet.getString(<span class="hljs-string">&quot;sex&quot;</span>);<br>                String address = resultSet.getString(<span class="hljs-string">&quot;address&quot;</span>);<br>                <span class="hljs-keyword">int</span> math = resultSet.getInt(<span class="hljs-string">&quot;math&quot;</span>);<br>                <span class="hljs-keyword">int</span> english = resultSet.getInt(<span class="hljs-string">&quot;english&quot;</span>);<br>                <span class="hljs-comment">//封装对象</span><br>                Student student = <span class="hljs-keyword">new</span> Student(id, name, age, sex, address, math, english);<br>                list.add(student);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (resultSet != <span class="hljs-keyword">null</span>) &#123;<br>                    resultSet.close();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (statement != <span class="hljs-keyword">null</span>) &#123;<br>                    statement.close();<br>                &#125;<br>                <span class="hljs-keyword">if</span> (connection != <span class="hljs-keyword">null</span>) &#123;<br>                    connection.close();<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="4-抽取JDBC工具类"><a href="#4-抽取JDBC工具类" class="headerlink" title="4. 抽取JDBC工具类"></a>4. 抽取JDBC工具类</h2><p><strong>目的：简化书写</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><br><span class="hljs-keyword">import</span> java.io.FileReader;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  简化JDBC操作的工具类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCUtils</span> </span>&#123;<br>    <span class="hljs-comment">//配置文件中的键对应的属性</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String user;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String password;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String url;<br><br>    <span class="hljs-keyword">static</span>&#123;<br>        <span class="hljs-comment">//在静态代码块中读取配置信息，可以减少读取次数</span><br>        <span class="hljs-comment">//读取配置文件</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.创建Properties对象</span><br>            Properties properties = <span class="hljs-keyword">new</span> Properties();<br>            <span class="hljs-comment">//2.加载文件</span><br>            ClassLoader classLoader = JDBCUtils.class.getClassLoader();<br>            InputStream resourceAsStream = classLoader.getResourceAsStream(<span class="hljs-string">&quot;jdbc.properties&quot;</span>);<br>            properties.load(resourceAsStream);<br><br><br>            <span class="hljs-comment">//获取值</span><br>            url = properties.getProperty(<span class="hljs-string">&quot;url&quot;</span>);<br>            user = properties.getProperty(<span class="hljs-string">&quot;user&quot;</span>);<br>            password = properties.getProperty(<span class="hljs-string">&quot;password&quot;</span>);<br>            <span class="hljs-comment">//注册驱动</span><br>            Class.forName(properties.getProperty(<span class="hljs-string">&quot;driver&quot;</span>));<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  获取连接对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> SQLException</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">return</span> DriverManager.getConnection(url, user, password);<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  释放资源(增删改)</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> stmt 执行sql语句对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> conn mysql连接对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Statement stmt, Connection conn)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (stmt != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stmt.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">//两个异常处理不能写一起，因为一旦前面语句出现异常，会导致后面资源不能正确被释放造成资源浪费</span><br>        <span class="hljs-keyword">if</span> (conn != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                conn.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  释放资源(查询)</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> stmt 执行sql语句对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> conn mysql连接对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> rs 存储查询结果集的对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Statement stmt, Connection conn, ResultSet rs)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (stmt != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stmt.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (conn != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                conn.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (rs != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                rs.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException se) &#123;<br>                se.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><strong>注意1：</strong></p>
<ol>
<li><p>抽取获取连接对象的方法时，如果使用用户传参的方式与实际代码中获取连接对象的代码一致，达不到简化效果，所以我们将url，user，password , driver 抽取到配置文件中</p>
<ol start="2">
<li>配置文件信息的读取涉及到IO流，所以应该是次数越少越好，所以我们将读取配置文件 和 注册驱动这两步放在静态代码块中，这样随着类的加载，配置文件只需读取一次就可以有所有我们需要的信息。</li>
</ol>
</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：JDBC工具类使用</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> org.wdzl.utils.JDBCUtils;<br><br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * JDBCUtils使用:查询Student表中id = 2 的学生信息</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo7</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-comment">//获取连接对象</span><br>        Connection connection = JDBCUtils.getConnection();<br>        <span class="hljs-comment">//编写sql</span><br>        String sql = <span class="hljs-string">&quot;select * from student where id=2&quot;</span>;<br>        <span class="hljs-comment">//获取statement对象</span><br>        Statement statement = connection.createStatement();<br>        ResultSet resultSet = statement.executeQuery(sql);<br><br>        <span class="hljs-comment">//处理结果</span><br>        <span class="hljs-keyword">while</span> (resultSet.next()) &#123;<br>            System.out.println(resultSet.getString(<span class="hljs-string">&quot;name&quot;</span>));<br>        &#125;<br><br>        <span class="hljs-comment">//释放资源</span><br>        JDBCUtils.close(statement,connection,resultSet);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><font color="cornflowerblue"><strong>演示案例2：模拟登陆</strong></font></p>
<p><strong>分析：</strong></p>
<pre><code>    1. 用户输入用户名，密码
      2. 数据库查询是否有该信息
   - 如果有,提示登录成功
   - 如果没有，提示用户名或密码错误
</code></pre>
<ol>
<li><p>数据库表准备</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> <span class="hljs-keyword">user</span>(<br>id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key  auto_increment,<br>username <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>password <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span><br><br>) <br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">values</span>(<span class="hljs-keyword">null</span>,<span class="hljs-string">&#x27;test&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>);<br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>;<br></code></pre></td></tr></table></figure></li>
<li><p>测试案例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> org.wdzl.utils.JDBCUtils;<br><br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  模拟用户登录</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo8</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        Scanner sc = <span class="hljs-keyword">new</span> Scanner(System.in);<br>        System.out.println(<span class="hljs-string">&quot;请输入用户名：&quot;</span>);<br>        String username = sc.next();<br>        System.out.println(<span class="hljs-string">&quot;请输入密码：&quot;</span>);<br>        String password = sc.next();<br>        <span class="hljs-comment">//登录</span><br>        <span class="hljs-keyword">boolean</span> flag = login(username, password);<br>        <span class="hljs-keyword">if</span> (flag) &#123;<br>            System.out.println(<span class="hljs-string">&quot;登录成功&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;登录失败&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  登录方法</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> username 用户名</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> password 密码</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">login</span><span class="hljs-params">(String username, String password)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">if</span> (username != <span class="hljs-keyword">null</span> &amp;&amp; password != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">//获取连接对象</span><br>            Connection connection = JDBCUtils.getConnection();<br>            String sql = <span class="hljs-string">&quot;select * from user where username=&#x27;&quot;</span> + username +<br>                    <span class="hljs-string">&quot;&#x27; and password = &#x27;&quot;</span> + password + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>            <span class="hljs-comment">//获取指定sql的对象</span><br>            Statement statement = connection.createStatement();<br>            <span class="hljs-comment">//执行sql</span><br>            ResultSet resultSet = statement.executeQuery(sql);<br>            <span class="hljs-comment">//判断</span><br>            <span class="hljs-keyword">return</span> resultSet.next();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><font color="red"><strong>这个案例中有一个很大的BUG：</strong></font></p>
<p>​    在控制台输入密码时，我们这样输入，用户名 随便输</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">a<span class="hljs-string">&#x27;or&#x27;</span>a<span class="hljs-string">&#x27;=&#x27;</span>a<br></code></pre></td></tr></table></figure>

<p>最终即便是密码用户名不匹配，依旧可以登录成功！这就是我们常说的 <font color="cornflowerblue">SQL注入</font>。</p>
<p><strong>SQL注入：</strong></p>
<p>​    因为某些关键字参与SQL语句拼接导致出现安全问题。</p>
<p><strong>如何解决SQL注入：</strong></p>
<p>​    使用 PreparedStatement</p>
</li>
</ol>
<h2 id="5-PreparedStatement-执行动态sql的对象"><a href="#5-PreparedStatement-执行动态sql的对象" class="headerlink" title="5. PreparedStatement: 执行动态sql的对象"></a>5. PreparedStatement: 执行动态sql的对象</h2><p>​        Statement 对象执行的sql 是在编译期就确定的</p>
<p>​        而PreparedStatement 执行的sql语句中，参数使用<code>？</code>占位符替代，在执行时通过某些方法给相应的占位符赋值才能获得完整的的SQL语句。这样就有效的防止了SQL注入</p>
<p><strong>步骤：</strong></p>
<ol>
<li>导入驱动Jar包</li>
<li> 注册驱动，让程序知道我们用的是哪个版本的驱动</li>
<li>获取数据库连接对象 Connection</li>
<li>定义SQL,参数使用占位符</li>
<li>获取执行动态SQL语句的对象PreparedStatement  ：<strong>Connection.PreparedStatement(String sql)</strong></li>
<li>给<code>?</code>占位符赋值<ul>
<li>setXxx（参数1，参数2）<ul>
<li>参数1：<code>？</code>的位置编号，从1开始</li>
<li>参数2： <code>？</code>对应的值</li>
</ul>
</li>
</ul>
</li>
<li>执行SQL，接收返回结果,执行时不需要再传递sql语句</li>
<li>处理结果</li>
<li>释放资源</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：改进登录代码</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  登录方法</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> username 用户名</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> password 密码</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">login</span><span class="hljs-params">(String username, String password)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">if</span> (username != <span class="hljs-keyword">null</span> &amp;&amp; password != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">//获取连接对象</span><br>            Connection connection = JDBCUtils.getConnection();<br>            String sql = <span class="hljs-string">&quot;select * from user where username=? and password = ?&quot;</span>;<br>            System.out.println(sql);<br>            <span class="hljs-comment">//获取指定sql的对象</span><br>            PreparedStatement statement = connection.prepareStatement(sql);<br>            <span class="hljs-comment">//设置？的值</span><br>            statement.setString(<span class="hljs-number">1</span>, username);<br>            statement.setString(<span class="hljs-number">2</span>,password);<br>            <span class="hljs-comment">//执行sql</span><br>            ResultSet resultSet = statement.executeQuery();<br>            <span class="hljs-comment">//判断</span><br>            <span class="hljs-keyword">return</span> resultSet.next();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><font color="red"><strong>后期开发我们都使用PreparedStatement。因为它可以防止SQL注入</strong></font></p>
<h2 id="6-JDBC-控制事务"><a href="#6-JDBC-控制事务" class="headerlink" title="6. JDBC 控制事务"></a>6. JDBC 控制事务</h2><h3 id="6-1-事务："><a href="#6-1-事务：" class="headerlink" title="6.1 事务："></a>6.1 事务：</h3><p>一个包含多个步骤的业务操作。如果这个业务被事务管理，则这多个步骤要么同时成功，要么同时失败。</p>
<h3 id="6-2-事务操作"><a href="#6-2-事务操作" class="headerlink" title="6.2 事务操作"></a>6.2 事务操作</h3><pre><code>1. 开启事务
 2. 提交事务
 3. 回滚事务
</code></pre>
<h3 id="6-3-使用Connection对象管理事务"><a href="#6-3-使用Connection对象管理事务" class="headerlink" title="6.3 使用Connection对象管理事务"></a>6.3 使用Connection对象管理事务</h3><ol>
<li>开启事务：**void  setAutoCommit(boolean autoCommit)**：调用该方法，参数为false，即开启事务<ul>
<li>获取Connection对象后即可开启事务</li>
</ul>
</li>
<li>提交事务：<strong>commit()</strong><ul>
<li>所有sql语句执行完毕后即可提交事务</li>
</ul>
</li>
<li>回滚事务:  <strong>rollback()</strong><ul>
<li>只要捕获异常，就在catch中进行事务回滚</li>
</ul>
</li>
</ol>
<p><strong><font color="cornflowerblue">演示案例：JDBC控制事务</font></strong></p>
<ol>
<li><p>准备数据库表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> zhuanzhang(<br>	NAME <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">10</span>),<br>	money <span class="hljs-keyword">DOUBLE</span>(<span class="hljs-number">7</span>,<span class="hljs-number">2</span>)<br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> zhuanzhang (NAME,money) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;张三&#x27;</span>,<span class="hljs-number">1000</span>),(<span class="hljs-string">&#x27;李四&#x27;</span>,<span class="hljs-number">1000</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> zhuanzhang;<br></code></pre></td></tr></table></figure></li>
<li><p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> org.wdzl.utils.JDBCUtils;<br><br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.PreparedStatement;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  JDBC 控制事务</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcDemo10</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br><br>        Connection connection = <span class="hljs-keyword">null</span>;<br>        PreparedStatement stmt1 = <span class="hljs-keyword">null</span>;<br>        PreparedStatement stmt2 = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//获取连接</span><br>            connection = JDBCUtils.getConnection();<br>            <span class="hljs-comment">//开启事务</span><br>            connection.setAutoCommit(<span class="hljs-keyword">false</span>);<br>            <span class="hljs-comment">//定义sql</span><br>            <span class="hljs-comment">//张三+500</span><br>            String sql1 = <span class="hljs-string">&quot;update zhuanzhang set money = money + ? where name = ?&quot;</span>;<br>            <span class="hljs-comment">//李四-500</span><br>            String sql2 = <span class="hljs-string">&quot;update zhuanzhang set money = money - ? where name = ?&quot;</span>;<br>            <span class="hljs-comment">//获取执行sql对象</span><br>            stmt1 = connection.prepareStatement(sql1);<br>            stmt2 = connection.prepareStatement(sql2);<br>            <span class="hljs-comment">//设置参数</span><br>            stmt1.setDouble(<span class="hljs-number">1</span>, <span class="hljs-number">500</span>);<br>            stmt1.setString(<span class="hljs-number">2</span>,<span class="hljs-string">&quot;张三&quot;</span>);<br><br>            stmt2.setDouble(<span class="hljs-number">1</span>, <span class="hljs-number">500</span>);<br>            stmt2.setString(<span class="hljs-number">2</span>,<span class="hljs-string">&quot;李四&quot;</span>);<br>            <span class="hljs-comment">//执行更新</span><br>            stmt1.execute();<span class="hljs-comment">//更新操作不能使用executeQuery()方法</span><br>            <span class="hljs-comment">//int a = 3 / 0;手动添加异常</span><br>            stmt2.execute();<br><br>            <span class="hljs-comment">//提交事务</span><br>            connection.commit();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">if</span> (connection != <span class="hljs-keyword">null</span>) &#123;<br>                connection.rollback();<br>            &#125;<br>            e.printStackTrace();<br>        &#125;<span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">//释放资源</span><br>            JDBCUtils.close(stmt1, connection);<br>            JDBCUtils.close(stmt2, <span class="hljs-keyword">null</span>);<br>        &#125;<br><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="7-数据库连接池"><a href="#7-数据库连接池" class="headerlink" title="7. 数据库连接池"></a>7. 数据库连接池</h2><p>数据库连接池类似于多线程种的线程池。</p>
<p><strong>概述：</strong></p>
<p>​    数据库连接池就是一个容器，存放了一些数据库连接对象。</p>
<p>​    当系统初始化完成后，容器被创建，容器会申请一些连接对象，当用户访问数据库时，从容器中获取连接对象即可。访问完之后，会将连接对象归还给连接池。这样做可以提高效率，提高连接对象的复用，不必频繁的创建和释放连接对象。</p>
<p><strong>实现：</strong></p>
<p>​    Java中提供了一个接口：<code>javax . sql . DataSource</code>。该接口是连接池技术的规范，具体实现由数据库厂商实现。该接口中定义了两个方法：</p>
<ul>
<li>​    方法：<ul>
<li>获取连接：getConnection()</li>
<li>归还连接：close() 。如果连接对象是从连接池中获得，那么调用Connection.close()将不再关闭连接，而                    是归还连接。</li>
</ul>
</li>
<li>连接池技术实现<ul>
<li>C3P0 ：数据库连接池技术</li>
<li>Druid: 由阿里巴巴提供的数据库连接池技术</li>
</ul>
</li>
</ul>
<h3 id="7-1-C3P0连接池"><a href="#7-1-C3P0连接池" class="headerlink" title="7.1 C3P0连接池"></a>7.1 C3P0连接池</h3><p><strong>步骤:</strong></p>
<ol>
<li><strong>导入Jar包</strong><ul>
<li>c3p0-0.9.5.2.jar</li>
<li>mchange-commons-java-0.2.12.jar</li>
</ul>
</li>
<li><strong>定义配置文件</strong>：<ul>
<li>规定名称：c3p0.properties 或者 c3p0-config.xml</li>
<li>规定路径：放在src目录下</li>
</ul>
</li>
<li><strong>创建核心对象</strong> ：数据库连接池对象 ComboPooledDataSource</li>
<li> <strong>获取连接</strong>： getConnection</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：入门案例</strong></font></p>
<ol>
<li>新建一个Module ,在Module中新建lib目录，将jar包拷贝的lib中，将配置文件拷贝到src下。<font color="red">不要忘记还有mysql连接驱动jar包</font></li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210119183607448.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119183607448"></p>
<ol start="2">
<li> 查看配置文件 c3p0-config.xml</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210119184000473.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119184000473"></p>
<ol start="3">
<li> 创建包和相应的演示案例类</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210119185248491.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119185248491"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wdzl.datasource.c3p0;<br><br><span class="hljs-keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  C3P0演示案例</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C3P0Demo1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>         <span class="hljs-comment">//1.创建数据库连接池对象</span><br>        DataSource dataSource = <span class="hljs-keyword">new</span> ComboPooledDataSource();<br>        <span class="hljs-comment">//2. 获取连接对象</span><br>        Connection connection = dataSource.getConnection();<br>        <span class="hljs-comment">//3. 查看连接对象</span><br>        System.out.println(connection);<br>		<span class="hljs-comment">//打印出对象信息就表示创建成功。</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<p><font color="cornflowerblue"><strong>演示案例：配置参数演示</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wdzl.datasource.c3p0;<br><br><span class="hljs-keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  C3P0 配置参数演示案例</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C3P0Demo2</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     验证 最大连接数 和 等待时间</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>         <span class="hljs-comment">//1.创建数据库连接池对象</span><br>        DataSource dataSource = <span class="hljs-keyword">new</span> ComboPooledDataSource();<br>        <span class="hljs-comment">//2. 获取连接对象：通过循环获取11个，前10个都能获取，第11个等待3秒就会报错</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">11</span>; i++) &#123;<br>            Connection connection = dataSource.getConnection();<br>            System.out.println(i+<span class="hljs-string">&quot; &quot;</span>+connection);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">      验证 连接池的连接会被归还</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-comment">//1.创建数据库连接池对象</span><br>        DataSource dataSource = <span class="hljs-keyword">new</span> ComboPooledDataSource();<br>        <span class="hljs-comment">//2. 获取连接对象：通过循环获取11个，前10个都能获取，第11个等待3秒就会报错</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">11</span>; i++) &#123;<br>            Connection connection = dataSource.getConnection();<br>            System.out.println(i+<span class="hljs-string">&quot; &quot;</span>+connection);<br><br>            <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) &#123;<br>                connection.close();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     指定配置信息:如果new ComboPooledDataSource()方法不传参数，则默认使用配置文件中的default-config</span><br><span class="hljs-comment">     如果指定字符串，使用指定名称的配置信息</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test3</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-comment">//1.创建数据库连接池对象</span><br>        DataSource dataSource = <span class="hljs-keyword">new</span> ComboPooledDataSource(<span class="hljs-string">&quot;otherc3p0&quot;</span>);<br>        <span class="hljs-comment">//2. 获取连接对象：通过循环获取11个，前10个都能获取，第11个等待3秒就会报错</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++) &#123;<br>            Connection connection = dataSource.getConnection();<br>            System.out.println(i+<span class="hljs-string">&quot; &quot;</span>+connection);<br>            &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="7-2-Druid-连接池-目前公认最先进的连接池技术"><a href="#7-2-Druid-连接池-目前公认最先进的连接池技术" class="headerlink" title="7.2 Druid 连接池 - 目前公认最先进的连接池技术"></a>7.2 Druid 连接池 - 目前公认最先进的连接池技术</h3><p><strong>步骤：</strong></p>
<ol>
<li>导包：druid-1.0.9.jar</li>
<li>定义配置文件：<ul>
<li>是properties形式的<pre><code>  * 可以叫任意名称，可以放在任意目录下
</code></pre>
</li>
</ul>
</li>
<li>加载配置文件：<strong>Properties</strong></li>
<li>获取数据库连接池对象：通过工厂来来获取  <strong>DruidDataSourceFactory</strong></li>
<li>获取连接：getConnection</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：</strong></font></p>
<ol>
<li>将jar包拷入lib目录，将配置 <code>druid.properties</code> 文件拷贝到src下</li>
<li>创建包，在包中创建演示案例类</li>
</ol>
<p><img src="/color-ful/img/javaee/image-20210119192041962.png" srcset="/color-ful/img/loading.gif" lazyload alt="image-20210119192041962"></p>
<ol start="3">
<li><p>测试案例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wdzl.datasource.druid;<br><br><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Druid 演示</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DruidDemo1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>         <span class="hljs-comment">//加载配置文件</span><br>        Properties properties = <span class="hljs-keyword">new</span> Properties();<br>        InputStream resourceAsStream = DruidDemo1.class.getClassLoader().getResourceAsStream(<span class="hljs-string">&quot;druid.properties&quot;</span>);<br>        properties.load(resourceAsStream);<br><br>        <span class="hljs-comment">//获取连接池对象</span><br>        DataSource dataSource = DruidDataSourceFactory.createDataSource(properties);<br>        Connection connection = dataSource.getConnection();<br><br>        <span class="hljs-comment">//查看连接对象</span><br>        System.out.println(connection);<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-3-定义Druid-工具类"><a href="#7-3-定义Druid-工具类" class="headerlink" title="7.3 定义Druid 工具类"></a>7.3 定义Druid 工具类</h3><p><strong>步骤：</strong></p>
<ol>
<li><p>定义一个工具类：JDBCUtils</p>
<ol start="2">
<li>提供静态代码块，加载配置文件，初始化连接池对象</li>
<li>提供方法</li>
</ol>
<ul>
<li>获取连接的方法：</li>
<li>释放资源：</li>
<li>获取连接池的方法：因为有一些框架自己会通过连接池获取连接对象。所以也需要提供这样一个方法。</li>
</ul>
</li>
</ol>
<p><font color="cornflowerblue"><strong>演示案例：JDBCUtils工具类</strong></font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> org.wdzl.datasource.utils;<br><br><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;<br><span class="hljs-keyword">import</span> com.mysql.jdbc.Statement;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.PreparedStatement;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Druid连接池工具类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCUtils</span> </span>&#123;<br>    <span class="hljs-comment">//成员变量</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DataSource dataSource;<br><br>    <span class="hljs-keyword">static</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1. 加载配置文件</span><br>            Properties properties = <span class="hljs-keyword">new</span> Properties();<br>            properties.load(JDBCUtils.class.getClassLoader().getResourceAsStream(<span class="hljs-string">&quot;druid.properties&quot;</span>));<br>            <span class="hljs-comment">//2. 获取连接池对象</span><br>            dataSource = DruidDataSourceFactory.createDataSource(properties);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  获取连接对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> 连接对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-keyword">return</span> dataSource.getConnection();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  释放资源</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> stmt 执行sql的对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> conn 连接数据库的对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Statement stmt, Connection conn)</span> </span>&#123;<br>         close(stmt,conn,<span class="hljs-keyword">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  释放资源</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> stmt 执行sql的对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> conn 连接数据库的对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> rs 查询结果集对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">(Statement stmt, Connection conn, ResultSet rs)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (stmt != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                stmt.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException throwables) &#123;<br>                throwables.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (conn != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                conn.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException throwables) &#123;<br>                throwables.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (rs != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                rs.close();<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException throwables) &#123;<br>                throwables.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  获取连接池对象</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> 连接池对象</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DataSource <span class="hljs-title">getDataSource</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> dataSource;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><strong><font color="cornflowerblue">演示案例2：使用工具类操作数据库</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  使用JDBC工具类操作数据库</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DruidDemo2</span> </span>&#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">      向student表中添加一条数据</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-comment">//1. 获取连接</span><br>        Connection connection = JDBCUtils.getConnection();<br>        <span class="hljs-comment">//2.定义sql</span><br>        String sql = <span class="hljs-string">&quot;insert into student (id,name,age,sex,address,math,english)&quot;</span> +<br>                <span class="hljs-string">&quot; values(?,?,?,?,?,?,?)&quot;</span>;<br>        <span class="hljs-comment">//3. 获取执行sql的对象</span><br>        PreparedStatement pst = connection.prepareStatement(sql);<br>        <span class="hljs-comment">//4. 给占位符赋值</span><br>        pst.setInt(<span class="hljs-number">1</span>, <span class="hljs-number">101</span>);<br>        pst.setString(<span class="hljs-number">2</span>,<span class="hljs-string">&quot;哈哈&quot;</span>);<br>        pst.setInt(<span class="hljs-number">3</span>, <span class="hljs-number">20</span>);<br>        pst.setString(<span class="hljs-number">4</span>,<span class="hljs-string">&quot;女&quot;</span>);<br>        pst.setString(<span class="hljs-number">5</span>,<span class="hljs-string">&quot;西安&quot;</span>);<br>        pst.setInt(<span class="hljs-number">6</span>,<span class="hljs-number">100</span>);<br>        pst.setInt(<span class="hljs-number">7</span>,<span class="hljs-number">100</span>);<br><br>        <span class="hljs-comment">//5.执行</span><br>        <span class="hljs-keyword">int</span> count = pst.executeUpdate();<br>        System.out.println(count);<br><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="8-Spring-JDBCTemplate"><a href="#8-Spring-JDBCTemplate" class="headerlink" title="8. Spring -JDBCTemplate"></a>8. Spring -JDBCTemplate</h2><p><strong>概述：</strong></p>
<p>Spring框架 对JDBC的简单封装，提供了一个JDBCTemplate对象，来简化JDBC的开发。</p>
<p><strong>步骤：</strong></p>
<ol>
<li><p>导包:Spring的5个jar包，mysql连接驱动包，Druid连接池jar包</p>
</li>
<li><p>创建JdbcTemplate对象。依赖于数据源DataSource</p>
</li>
<li><p>调用JdbcTemplate的方法来完成CRUD操作</p>
<ul>
<li><strong>update()</strong> : 执行DML语句。增，删，改语句。</li>
<li><strong>queryForMap()</strong>:查询结果，将结果封装为Map集合</li>
<li><strong>queryForList()</strong>:查询结果，将结果集封装为List集合</li>
<li>**query()**：查询结果，将结果封装为JavaBean对象</li>
<li><strong>queryForObject()</strong>:查询结果，将结果封装为对象</li>
</ul>
<p><font color="red">练习中会对上述方法进行详细说明</font></p>
</li>
</ol>
<p><strong><font color="cornflowerblue">入门案例：</font></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  JDBCTemplate 入门</span><br><span class="hljs-comment"> *  新项目中我们需要使用JDBCTemplate, 我们需要先添加Druid连接池的jar包和配置文件，添加JDBCUtiles工具类，才能使用JDBCTemplate。</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCTemplateDemo</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">//1. 创建JDBCTemplate对象</span><br>        JdbcTemplate template = <span class="hljs-keyword">new</span> JdbcTemplate(JDBCUtils.getDataSource());<br>        <span class="hljs-comment">//2.调用方法</span><br>        String sql = <span class="hljs-string">&quot;update student set sex=?,address=? where id=?&quot;</span>;<br>        <span class="hljs-comment">// 有几个？，就在update()方法中传几个参数即可。</span><br>        <span class="hljs-keyword">int</span> update = template.update(sql, <span class="hljs-string">&quot;男&quot;</span>, <span class="hljs-string">&quot;太原&quot;</span>, <span class="hljs-number">20</span>);<br>        System.out.println(update);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>使用JDBCTemplate操作数据库只关心sql的编写 和 执行，其他的操作JDBCTemplate都会替我们完成。</strong></p>
<p><font color="cornflowerblue"><strong>演示案例：DML,DQL语句</strong></font></p>
<p><strong>需求：</strong>使用Student表，将Student实体类复制到当前工程中</p>
<pre><code>      1. 修改id为3 的学生数据，将 age改为 30
     2. 添加一条记录
    3. 删除刚才添加的记录
    4. 查询id为3的记录，将其封装为Map集合
    5. 查询所有记录，将其封装为List集合
    6. 查询所有记录，将其封装为Student对象的List集合
    7. 查询name=&quot;埃隆马斯克&quot; 的学生信息，并封装成Student对象
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;<br><span class="hljs-keyword">import</span> org.springframework.jdbc.core.RowMapper;<br><span class="hljs-keyword">import</span> org.wdzl.datasource.utils.JDBCUtils;<br><span class="hljs-keyword">import</span> org.wdzl.pojo.Student;<br><br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  JDBCTemplate 入门</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDBCTemplateDemo2</span> </span>&#123;<br>    <span class="hljs-comment">//方便使用</span><br>    <span class="hljs-keyword">private</span>  JdbcTemplate template = <span class="hljs-keyword">new</span> JdbcTemplate(JDBCUtils.getDataSource());<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        修改id为3 的学生数据，将 age改为 30</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//1.获取连接对象</span><br><span class="hljs-comment">//        JdbcTemplate template = new JdbcTemplate(JDBCUtils.getDataSource());</span><br>        <span class="hljs-comment">//2.编写sql</span><br>        String sql = <span class="hljs-string">&quot;update student set age=? where id=?&quot;</span>;<br>        <span class="hljs-comment">//3.执行sql，给占位符赋值</span><br>        <span class="hljs-keyword">int</span> update = template.update(sql, <span class="hljs-number">30</span>, <span class="hljs-number">3</span>);<br>        System.out.println(update);<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    添加一条记录</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//2.编写sql</span><br>        String sql = <span class="hljs-string">&quot;insert into student values(?,?,?,?,?,?,?)&quot;</span>;<br>        <span class="hljs-comment">//3. 执行</span><br>        <span class="hljs-keyword">int</span> update = template.update(sql, <span class="hljs-number">22</span>, <span class="hljs-string">&quot;刘德华&quot;</span>, <span class="hljs-number">25</span>, <span class="hljs-string">&quot;男&quot;</span>, <span class="hljs-string">&quot;香港&quot;</span>, <span class="hljs-number">80</span>, <span class="hljs-number">75</span>);<br>        System.out.println(update);<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     删除刚添加的记录</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test3</span><span class="hljs-params">()</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;delete from student where id=?&quot;</span>;<br>        <span class="hljs-keyword">int</span> update = template.update(sql, <span class="hljs-number">22</span>);<br>        System.out.println(update);<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    查询id为3的记录，将其封装为Map集合</span><br><span class="hljs-comment">    queryForMap():将记录的字段名作为键，字段值作为值封装到map集合中。</span><br><span class="hljs-comment">    map格式 ： 字段名 = 字段值</span><br><span class="hljs-comment">    注意： 结果集长度只能是1 超过则会报错</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test4</span><span class="hljs-params">()</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;select * from student where id=?&quot;</span>;<br>        Map&lt;String, Object&gt; map = template.queryForMap(sql, <span class="hljs-number">3</span>);<br><span class="hljs-comment">//        String sql = &quot;select * from student where id=? or id=?&quot;;</span><br><span class="hljs-comment">//        Map&lt;String, Object&gt; map = template.queryForMap(sql, 3,4);//报错，因为记录超过两条</span><br>        System.out.println(map);<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     查询所有记录，将其封装为List集合</span><br><span class="hljs-comment">     queryForList():将每一条记录封装到map集合，再把每一条记录的map集合存入list集合</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test5</span><span class="hljs-params">()</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;select * from student&quot;</span>;<br>        List&lt;Map&lt;String, Object&gt;&gt; maps = template.queryForList(sql);<br>        <span class="hljs-keyword">for</span> (Map&lt;String, Object&gt; map : maps) &#123;<br>            System.out.println(map);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        查询所有记录，将其封装为Student对象的List集合--方式1</span><br><span class="hljs-comment">        template.query(sql, new RowMapper&lt;Student&gt;() &#123;mapRow()&#125;);</span><br><span class="hljs-comment">        该方法需要自己实现一个接口，每查询一条记录就会执行一次接口里面的mapRow()方法，将结果进行封装</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test6</span><span class="hljs-params">()</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;select * from student&quot;</span>;<br><br>        List&lt;Student&gt; students = template.query(sql, <span class="hljs-keyword">new</span> RowMapper&lt;Student&gt;() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">mapRow</span><span class="hljs-params">(ResultSet resultSet, <span class="hljs-keyword">int</span> i)</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>                <span class="hljs-keyword">int</span> id = resultSet.getInt(<span class="hljs-string">&quot;id&quot;</span>);<br>                String name = resultSet.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>                <span class="hljs-keyword">int</span> age = resultSet.getInt(<span class="hljs-string">&quot;age&quot;</span>);<br>                String sex = resultSet.getString(<span class="hljs-string">&quot;sex&quot;</span>);<br>                String address = resultSet.getString(<span class="hljs-string">&quot;address&quot;</span>);<br>                <span class="hljs-keyword">int</span> math = resultSet.getInt(<span class="hljs-string">&quot;math&quot;</span>);<br>                <span class="hljs-keyword">int</span> english = resultSet.getInt(<span class="hljs-string">&quot;english&quot;</span>);<br>                Student student = <span class="hljs-keyword">new</span> Student(id, name, age, sex, address, math, english);<br>                <span class="hljs-keyword">return</span> student;<br>            &#125;<br>        &#125;);<br><br>        <span class="hljs-comment">//遍历集合</span><br>        <span class="hljs-keyword">for</span> (Student student : students) &#123;<br>            System.out.println(student);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">       查询所有记录，将其封装为Student对象的List集合-方式2</span><br><span class="hljs-comment">       template.query(sql,new BeanPropertyRowMapper&lt;实体类&gt;(实体类.class))</span><br><span class="hljs-comment">       注意：如果用方式2，你的实体类中属性的基本数据类型一定要定义成包装类型，否则如果你的查询记录中有null的话 会报错，因为</span><br><span class="hljs-comment">       基本数据类型中不能存null</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test6_2</span><span class="hljs-params">()</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;select * from student&quot;</span>;<br><br>        List&lt;Student&gt; students = template.query(sql,<span class="hljs-keyword">new</span> BeanPropertyRowMapper&lt;Student&gt;(Student.class));<br><br>        <span class="hljs-comment">//遍历集合</span><br>        <span class="hljs-keyword">for</span> (Student student : students) &#123;<br>            System.out.println(student);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    查询name=&quot;埃隆马斯克&quot; 的学生信息，并封装成Student对象</span><br><span class="hljs-comment">    queryForObject(sql,new BeanPropertyRowMapper&lt;&gt;(封装的实体类.class),参数)</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test7</span><span class="hljs-params">()</span> </span>&#123;<br>        String sql = <span class="hljs-string">&quot;select * from student where name=?&quot;</span>;<br>        Student student = template.queryForObject(sql, <span class="hljs-keyword">new</span> BeanPropertyRowMapper&lt;&gt;(Student.class),<span class="hljs-string">&quot;埃隆马斯克&quot;</span>);<br>        System.out.println(student);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/color-ful/categories/JavaEE-%E4%BA%8C%E9%98%B6/">JavaEE 二阶</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/color-ful/tags/JDBC/">JDBC</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/color-ful/2020/01/17/1.XML/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">XML</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/color-ful/2020/01/17/4.%E4%BA%8C%E9%98%B6%E6%AE%B5%E9%A1%B9%E7%9B%AE-%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">
                        <span class="hidden-mobile">二阶段练习项目：图书管理系统</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/color-ful/js/debouncer.js" ></script>
<script  src="/color-ful/js/events.js" ></script>
<script  src="/color-ful/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/color-ful/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/color-ful/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/color-ful/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/color-ful/js/boot.js" ></script>


</body>
</html>
